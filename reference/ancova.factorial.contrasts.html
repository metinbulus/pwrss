<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Factorial Contrasts — factorial.contrasts • pwrss</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Factorial Contrasts — factorial.contrasts"><meta name="description" content="

Helper function to construct the default contrast coefficients for various coding schemes.
Note that R has a partial matching feature which allows you to specify shortened versions of arguments, such as coding instead of coding.scheme.
Validated using lm() and aov() functions."><meta property="og:description" content="

Helper function to construct the default contrast coefficients for various coding schemes.
Note that R has a partial matching feature which allows you to specify shortened versions of arguments, such as coding instead of coding.scheme.
Validated using lm() and aov() functions."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pwrss</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/examples.html">Practical Power Analysis in R</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/metinbulus/pwrss/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Factorial Contrasts</h1>

      <div class="d-none name"><code>ancova.factorial.contrasts.Rd</code></div>
    </div>

    <div class="ref-description section level2">


<p>Helper function to construct the default contrast coefficients for various coding schemes.</p>
<p>Note that R has a partial matching feature which allows you to specify shortened versions of arguments, such as <code>coding</code> instead of <code>coding.scheme</code>.</p>
<p>Validated using <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> and <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">factorial.contrasts</span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                    coding.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"deviation"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">factor.levels</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    base <span class="op">=</span> <span class="va">factor.levels</span>,</span>
<span>                    intercept <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-factor-levels">factor.levels<a class="anchor" aria-label="anchor" href="#arg-factor-levels"></a></dt>
<dd><p>Integer. Number of levels or groups in each factor. For example, for two factors each having two levels or groups use e.g. c(2, 2), for three factors each having two levels or groups use e.g. c(2, 2, 2)</p></dd>

  <dt id="arg-coding-scheme">coding.scheme<a class="anchor" aria-label="anchor" href="#arg-coding-scheme"></a></dt>
<dd><p>Character vector. Coding scheme for each factor. "sum" for deviation or effect coding, "treatment" for dummy coding, "helmert" for Helmert type of coding, and "poly" for polynomial coding. Each factor can have their own coding scheme. If a single character value is provided, it will be copied to other factors</p></dd>

  <dt id="arg-base">base<a class="anchor" aria-label="anchor" href="#arg-base"></a></dt>
<dd><p>Integer vector. Specifies which group is considered the baseline group. Ignored for coding schemes other than "treatment"</p></dd>

  <dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>Logical. <code>FALSE</code> by default. If <code>TRUE</code> contrast matrix includes the intercept</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. <code>TRUE</code> by default. If <code>FALSE</code> no output is printed on the console</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<dl><dt>factor.levels</dt>
<dd><p>Number of levels (or groups) in each factor</p></dd>

  <dt>factor.data</dt>
<dd><p>Unique combination of factor levels</p></dd>

  <dt>model.matrix</dt>
<dd><p>Model (design) matrix based on unique combination of factor levels</p></dd>

  <dt>contrast.matrix</dt>
<dd><p>Contrast matrix</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###################################################</span></span></span>
<span class="r-in"><span><span class="co">############### dummy coding scheme ###############</span></span></span>
<span class="r-in"><span><span class="co">####################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># one factor w/ 3 levels</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span> <span class="op">&lt;-</span> <span class="fu">factorial.contrasts</span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                                       coding <span class="op">=</span> <span class="st">"treatment"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    A1 A2 A3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2  0  1 -1</span>
<span class="r-in"><span><span class="co"># model matrix</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span><span class="op">$</span><span class="va">model.matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept) A1 A2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           1  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"assign")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")$A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># contrast matrix</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span><span class="op">$</span><span class="va">contrast.matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    A1 A2 A3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2  0  1 -1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#######################################################</span></span></span>
<span class="r-in"><span><span class="co">###############  deviation coding scheme ##############</span></span></span>
<span class="r-in"><span><span class="co">#######################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># especially useful for factorial designs</span></span></span>
<span class="r-in"><span><span class="co"># two factors w/ 2 and 3 levels, respectively</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span> <span class="op">&lt;-</span> <span class="fu">factorial.contrasts</span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                       coding <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming the same coding scheme applies to the other factor(s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Elements of `mu.vector`, `sd.vector`, `n.vector` or `p.vector` should follow this specific order:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> A1:B1  A1:B2  A1:B3  A2:B1  A2:B2  A2:B3  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A1:B1  A1:B2  A1:B3  A2:B1  A2:B2  A2:B3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1     0.167  0.167  0.167 -0.167 -0.167 -0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B1     0.333 -0.167 -0.167  0.333 -0.167 -0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B2    -0.167  0.333 -0.167 -0.167  0.333 -0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1:B1  0.333 -0.167 -0.167 -0.333  0.167  0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1:B2 -0.167  0.333 -0.167  0.167 -0.333  0.167</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model matrix</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span><span class="op">$</span><span class="va">model.matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept) A1 B1 B2 A1:B1 A1:B2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1  1  1  0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           1  1  0  1     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           1  1 -1 -1    -1    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           1 -1  1  0    -1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           1 -1  0  1     0    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           1 -1 -1 -1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"assign")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 1 2 2 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")$A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")$B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># contrast matrix</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span><span class="op">$</span><span class="va">contrast.matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            A1:B1      A1:B2      A1:B3      A2:B1      A2:B2      A2:B3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1     0.1666667  0.1666667  0.1666667 -0.1666667 -0.1666667 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B1     0.3333333 -0.1666667 -0.1666667  0.3333333 -0.1666667 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B2    -0.1666667  0.3333333 -0.1666667 -0.1666667  0.3333333 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1:B1  0.3333333 -0.1666667 -0.1666667 -0.3333333  0.1666667  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1:B2 -0.1666667  0.3333333 -0.1666667  0.1666667 -0.3333333  0.1666667</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################################</span></span></span>
<span class="r-in"><span><span class="co">###############  Helmert coding scheme ###############</span></span></span>
<span class="r-in"><span><span class="co">######################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># one factor w/ 3 levels</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span> <span class="op">&lt;-</span> <span class="fu">factorial.contrasts</span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                                       coding <span class="op">=</span> <span class="st">"helmert"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A1     A2    A3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1 -0.500  0.500 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2 -0.167 -0.167 0.333</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model matrix</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span><span class="op">$</span><span class="va">model.matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept) A1 A2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1 -1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           1  1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           1  0  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"assign")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")$A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># contrast matrix</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span><span class="op">$</span><span class="va">contrast.matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            A1         A2        A3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1 -0.5000000  0.5000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2 -0.1666667 -0.1666667 0.3333333</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#########################################################</span></span></span>
<span class="r-in"><span><span class="co">###############  polynomial coding scheme ###############</span></span></span>
<span class="r-in"><span><span class="co">#########################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># one factor w/ 3 levels</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span> <span class="op">&lt;-</span> <span class="fu">factorial.contrasts</span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                                       coding <span class="op">=</span> <span class="st">"poly"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         A1     A2    A3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A.L -0.707  0.000 0.707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A.Q  0.408 -0.816 0.408</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model matrix</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span><span class="op">$</span><span class="va">model.matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept)           A.L        A.Q</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1 -7.071068e-01  0.4082483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           1 -7.850462e-17 -0.8164966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           1  7.071068e-01  0.4082483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"assign")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")$A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              .L         .Q</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -7.071068e-01  0.4082483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -7.850462e-17 -0.8164966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  7.071068e-01  0.4082483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># contrast matrix</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span><span class="op">$</span><span class="va">contrast.matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             A1         A2        A3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A.L -0.7071068  0.0000000 0.7071068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A.Q  0.4082483 -0.8164966 0.4082483</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Metin Bulus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

