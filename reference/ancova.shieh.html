<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Power Analysis for One-, Two-, Three-Way ANCOVA Using Means, Standard Deviations, and (Optionally) Contrasts (F test) — power.f.ancova.shieh • pwrss</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power Analysis for One-, Two-, Three-Way ANCOVA Using Means, Standard Deviations, and (Optionally) Contrasts (F test) — power.f.ancova.shieh"><meta name="description" content="Calculates power or sample size for one-, two-, three-way ANCOVA. For factorial designs, use the argument factor.levels but note that unique combination of levels (cells in this case) should follow a specific order for the test of interaction. The order of marginal means and standard deviations  is printed as a warning message.
Note that R has a partial matching feature which allows you to specify shortened versions of arguments, such as mu or mu.vec instead of mu.vector, or such as k or k.cov instead of k.covariates.
Formulas are validated using examples and tables in Shieh (2020)."><meta property="og:description" content="Calculates power or sample size for one-, two-, three-way ANCOVA. For factorial designs, use the argument factor.levels but note that unique combination of levels (cells in this case) should follow a specific order for the test of interaction. The order of marginal means and standard deviations  is printed as a warning message.
Note that R has a partial matching feature which allows you to specify shortened versions of arguments, such as mu or mu.vec instead of mu.vector, or such as k or k.cov instead of k.covariates.
Formulas are validated using examples and tables in Shieh (2020)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pwrss</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/examples.html">Practical Power Analysis in R</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/metinbulus/pwrss/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Power Analysis for One-, Two-, Three-Way ANCOVA Using Means, Standard Deviations, and (Optionally) Contrasts (F test)</h1>

      <div class="d-none name"><code>ancova.shieh.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates power or sample size for one-, two-, three-way ANCOVA. For factorial designs, use the argument <code>factor.levels</code> but note that unique combination of levels (cells in this case) should follow a specific order for the test of interaction. The order of marginal means and standard deviations  is printed as a warning message.</p>
<p>Note that R has a partial matching feature which allows you to specify shortened versions of arguments, such as <code>mu</code> or <code>mu.vec</code> instead of <code>mu.vector</code>, or such as <code>k</code> or <code>k.cov</code> instead of <code>k.covariates</code>.</p>
<p>Formulas are validated using examples and tables in Shieh (2020).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">power.f.ancova.shieh</span><span class="op">(</span><span class="va">mu.vector</span>, <span class="va">sd.vector</span>,</span>
<span>                     n.vector <span class="op">=</span> <span class="cn">NULL</span>, p.vector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mu.vector</span><span class="op">)</span>,</span>
<span>                     r.squared <span class="op">=</span> <span class="fl">0</span>, k.covariates <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                     contrast.matrix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     power <span class="op">=</span> <span class="cn">NULL</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                     ceiling <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     pretty <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-mu-vector">mu.vector<a class="anchor" aria-label="anchor" href="#arg-mu-vector"></a></dt>
<dd><p>vector; adjusted means (or estimated marginal means) for each level of a factor.</p></dd>

  <dt id="arg-sd-vector">sd.vector<a class="anchor" aria-label="anchor" href="#arg-sd-vector"></a></dt>
<dd><p>vector; unadjusted standard deviations for each level of a factor. If a pooled standard deviation is provided, repeat its value to match the number of group means. A warning will be issued if group standard deviations differ substantially beyond what is expected due to sampling error.</p></dd>

  <dt id="arg-n-vector">n.vector<a class="anchor" aria-label="anchor" href="#arg-n-vector"></a></dt>
<dd><p>vector; sample sizes for each level of a factor.</p></dd>

  <dt id="arg-p-vector">p.vector<a class="anchor" aria-label="anchor" href="#arg-p-vector"></a></dt>
<dd><p>vector; proportion of total sample size in each level of a factor. These proportions should sum to one.</p></dd>

  <dt id="arg-factor-levels">factor.levels<a class="anchor" aria-label="anchor" href="#arg-factor-levels"></a></dt>
<dd><p>integer; number of levels or groups in each factor. For example, for two factors each having two levels or groups use e.g. c(2, 2), for three factors each having two levels or groups use e.g. c(2, 2, 2).</p></dd>

  <dt id="arg-r-squared">r.squared<a class="anchor" aria-label="anchor" href="#arg-r-squared"></a></dt>
<dd><p>explanatory power of covariates (R-squared) in the ANCOVA model.</p></dd>

  <dt id="arg-k-covariates">k.covariates<a class="anchor" aria-label="anchor" href="#arg-k-covariates"></a></dt>
<dd><p>integer; number of covariates in the ANCOVA model.</p></dd>

  <dt id="arg-contrast-matrix">contrast.matrix<a class="anchor" aria-label="anchor" href="#arg-contrast-matrix"></a></dt>
<dd><p>vector or matrix; contrasts should not be confused with the model (design) matrix. Rows of contrast matrix indicate independent vector of contrasts summing to zero. The default contrast matrix is constructed using deviation coding scheme (a.k.a. effect coding). Columns in the contrast matrix indicate number of levels or groups (or cells in factorial designs).</p></dd>

   <dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>statistical power, defined as the probability of correctly rejecting a false null hypothesis, denoted as \(1 - \beta\).</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>type 1 error rate, defined as the probability of incorrectly rejecting a true null hypothesis, denoted as \(\alpha\).</p></dd>

  <dt id="arg-ceiling">ceiling<a class="anchor" aria-label="anchor" href="#arg-ceiling"></a></dt>
<dd><p>logical;  <code>TRUE</code> by default. If <code>FALSE</code> sample size in each cell is NOT rounded up.</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical; <code>TRUE</code> by default. If <code>FALSE</code> no output is printed on the console.</p></dd>

  <dt id="arg-pretty">pretty<a class="anchor" aria-label="anchor" href="#arg-pretty"></a></dt>
<dd><p>logical; whether the output should show Unicode characters (if encoding allows for it). <code>FALSE</code> by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<dl><dt>parms</dt>
<dd><p>list of parameters used in calculation.</p></dd>

  <dt>test</dt>
<dd><p>type of the statistical test (F-Test)</p></dd>

  <dt>eta.squared</dt>
<dd><p>(partial) eta-squared.</p></dd>

  <dt>f</dt>
<dd><p>Cohen's f statistic.</p></dd>

  <dt>df1</dt>
<dd><p>numerator degrees of freedom.</p></dd>

  <dt>df2</dt>
<dd><p>denominator degrees of freedom.</p></dd>

  <dt>ncp</dt>
<dd><p>non-centrality parameter for the alternative.</p></dd>

  <dt>null.ncp</dt>
<dd><p>non-centrality parameter for the null.</p></dd>

  <dt>power</dt>
<dd><p>statistical power \((1-\beta)\).</p></dd>

  <dt>n.total</dt>
<dd><p>total sample size.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Shieh, G. (2020). Power analysis and sample size planning in ANCOVA designs. Psychometrika, 85(1), 101-120. <a href="https://doi.org/10.1007/s11336-019-09692-3" class="external-link">doi:10.1007/s11336-019-09692-3</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">###################################################################</span></span></span>
<span class="r-in"><span><span class="co">##########################  main effect  ##########################</span></span></span>
<span class="r-in"><span><span class="co">###################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># power for one-way ANCOVA (two levels or groups)</span></span></span>
<span class="r-in"><span><span class="fu">power.f.ancova.shieh</span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.20</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># marginal means</span></span></span>
<span class="r-in"><span>                     sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span></span>
<span class="r-in"><span>                     n.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">150</span><span class="op">)</span>, <span class="co"># sample sizes</span></span></span>
<span class="r-in"><span>                     r.squared <span class="op">=</span> <span class="fl">0.50</span>, <span class="co"># proportion of variance explained by covariates</span></span></span>
<span class="r-in"><span>                     k.covariates <span class="op">=</span> <span class="fl">1</span>, <span class="co"># number of covariates</span></span></span>
<span class="r-in"><span>                     alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |                POWER CALCULATION                 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> One-way Analysis of Covariance (F-Test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : eta.squared = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : eta.squared &gt; 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total Sample Size      = 300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 1 Error (alpha)   = 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 2 Error (beta)    = 0.316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Power      = 0.684  &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sample size for one-way ANCOVA (two levels or groups)</span></span></span>
<span class="r-in"><span><span class="fu">power.f.ancova.shieh</span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.20</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># marginal means</span></span></span>
<span class="r-in"><span>                     sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span></span>
<span class="r-in"><span>                     p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.50</span><span class="op">)</span>, <span class="co"># allocation, should sum to 1</span></span></span>
<span class="r-in"><span>                     r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span></span>
<span class="r-in"><span>                     k.covariates <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                     alpha <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                     power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             SAMPLE SIZE CALCULATION              |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> One-way Analysis of Covariance (F-Test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : eta.squared = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : eta.squared &gt; 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total Sample Size      = 396  &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 1 Error (alpha)   = 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 2 Error (beta)    = 0.199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Power      = 0.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###################################################################</span></span></span>
<span class="r-in"><span><span class="co">#######################  interaction effect  ######################</span></span></span>
<span class="r-in"><span><span class="co">###################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sample size for two-way ANCOVA (2 x 2)</span></span></span>
<span class="r-in"><span><span class="fu">power.f.ancova.shieh</span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.20</span>, <span class="fl">0.25</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span><span class="op">)</span>, <span class="co"># marginal means</span></span></span>
<span class="r-in"><span>                     sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span></span>
<span class="r-in"><span>                     p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="co"># allocation, should sum to 1</span></span></span>
<span class="r-in"><span>                     factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># 2 by 2 factorial design</span></span></span>
<span class="r-in"><span>                     r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span></span>
<span class="r-in"><span>                     k.covariates <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                     alpha <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                     power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Elements of `mu.vector`, `sd.vector`, `n.vector` or `p.vector` should follow this specific order:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> A1:B1  A1:B2  A2:B1  A2:B2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             SAMPLE SIZE CALCULATION              |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Two-way Analysis of Covariance (F-Test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : eta.squared = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : eta.squared &gt; 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total Sample Size      = 2796  &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 1 Error (alpha)   = 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 2 Error (beta)    = 0.200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Power      = 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Elements of `mu.vector`, `sd.vector`, `n.vector` or `p.vector` should follow this specific order:</span></span></span>
<span class="r-in"><span><span class="co">#  A1:B1  A1:B2  A2:B1  A2:B2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###################################################################</span></span></span>
<span class="r-in"><span><span class="co">#######################  planned contrasts  #######################</span></span></span>
<span class="r-in"><span><span class="co">###################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#########################</span></span></span>
<span class="r-in"><span><span class="co">## dummy coding scheme ##</span></span></span>
<span class="r-in"><span><span class="co">#########################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span> <span class="op">&lt;-</span> <span class="fu"><a href="ancova.factorial.contrasts.html">factorial.contrasts</a></span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fl">3</span>, <span class="co"># one factor w/ 3 levels</span></span></span>
<span class="r-in"><span>                                       coding <span class="op">=</span> <span class="st">"treatment"</span><span class="op">)</span> <span class="co"># use dummy coding scheme</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    A1 A2 A3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2  0  1 -1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get contrast matrix from the contrast object</span></span></span>
<span class="r-in"><span><span class="va">contrast.matrix</span> <span class="op">&lt;-</span> <span class="va">contrast.object</span><span class="op">$</span><span class="va">contrast.matrix</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate sample size given design characteristics</span></span></span>
<span class="r-in"><span><span class="va">ancova.design</span> <span class="op">&lt;-</span> <span class="fu">power.f.ancova.shieh</span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span><span class="op">)</span>, <span class="co"># marginal means</span></span></span>
<span class="r-in"><span>                                      sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span></span>
<span class="r-in"><span>                                      p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, <span class="co"># allocation, should sum to 1</span></span></span>
<span class="r-in"><span>                                      contrast.matrix <span class="op">=</span> <span class="va">contrast.matrix</span>,</span></span>
<span class="r-in"><span>                                      r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span></span>
<span class="r-in"><span>                                      k.covariates <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                      alpha <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                                      power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             SAMPLE SIZE CALCULATION              |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> One-way Analysis of Covariance (F-Test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : eta.squared = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : eta.squared &gt; 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total Sample Size      = 1245  &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 1 Error (alpha)   = 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 2 Error (beta)    = 0.199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Power      = 0.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># power of planned contrasts, adjusted for alpha level</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ancova.contrasts.html">power.t.contrasts</a></span><span class="op">(</span><span class="va">ancova.design</span>, adjust.alpha <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |                POWER CALCULATION                 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Analyses (T-Tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : psi = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : psi != 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contr comparison   psi      d    ncp n.total power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  A1 &lt;=&gt; A3 -0.05 -0.071 -1.018    1245 0.111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2  A2 &lt;=&gt; A3  0.10  0.141  2.036    1245 0.418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###########################</span></span></span>
<span class="r-in"><span><span class="co">## Helmert coding scheme ##</span></span></span>
<span class="r-in"><span><span class="co">###########################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span> <span class="op">&lt;-</span> <span class="fu"><a href="ancova.factorial.contrasts.html">factorial.contrasts</a></span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fl">3</span>, <span class="co"># one factor w/ 4 levels</span></span></span>
<span class="r-in"><span>                                       coding <span class="op">=</span> <span class="st">"helmert"</span><span class="op">)</span> <span class="co"># use helmert coding scheme</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A1     A2    A3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1 -0.500  0.500 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2 -0.167 -0.167 0.333</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get contrast matrix from the contrast object</span></span></span>
<span class="r-in"><span><span class="va">contrast.matrix</span> <span class="op">&lt;-</span> <span class="va">contrast.object</span><span class="op">$</span><span class="va">contrast.matrix</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate sample size given design characteristics</span></span></span>
<span class="r-in"><span><span class="va">ancova.design</span> <span class="op">&lt;-</span> <span class="fu">power.f.ancova.shieh</span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span><span class="op">)</span>, <span class="co"># marginal means</span></span></span>
<span class="r-in"><span>                                      sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span></span>
<span class="r-in"><span>                                      p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, <span class="co"># allocation, should sum to 1</span></span></span>
<span class="r-in"><span>                                      contrast.matrix <span class="op">=</span> <span class="va">contrast.matrix</span>,</span></span>
<span class="r-in"><span>                                      r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span></span>
<span class="r-in"><span>                                      k.covariates <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                      alpha <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                                      power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             SAMPLE SIZE CALCULATION              |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> One-way Analysis of Covariance (F-Test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : eta.squared = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : eta.squared &gt; 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total Sample Size      = 1245  &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 1 Error (alpha)   = 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 2 Error (beta)    = 0.199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Power      = 0.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># power of planned contrasts</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ancova.contrasts.html">power.t.contrasts</a></span><span class="op">(</span><span class="va">ancova.design</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |                POWER CALCULATION                 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Analyses (T-Tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : psi = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : psi != 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contr   comparison    psi      d    ncp n.total power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1    A2 &lt;=&gt; A1  0.075  0.106  3.055    1245 0.863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2 A3 &lt;=&gt; A1 A2 -0.008 -0.012 -0.588    1245 0.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##############################</span></span></span>
<span class="r-in"><span><span class="co">## polynomial coding scheme ##</span></span></span>
<span class="r-in"><span><span class="co">##############################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span> <span class="op">&lt;-</span> <span class="fu"><a href="ancova.factorial.contrasts.html">factorial.contrasts</a></span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fl">3</span>, <span class="co"># one factor w/ 4 levels</span></span></span>
<span class="r-in"><span>                                       coding <span class="op">=</span> <span class="st">"poly"</span><span class="op">)</span> <span class="co"># use polynomial coding scheme</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         A1     A2    A3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A.L -0.707  0.000 0.707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A.Q  0.408 -0.816 0.408</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get contrast matrix from the contrast object</span></span></span>
<span class="r-in"><span><span class="va">contrast.matrix</span> <span class="op">&lt;-</span> <span class="va">contrast.object</span><span class="op">$</span><span class="va">contrast.matrix</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate sample size given design characteristics</span></span></span>
<span class="r-in"><span><span class="va">ancova.design</span> <span class="op">&lt;-</span> <span class="fu">power.f.ancova.shieh</span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span><span class="op">)</span>, <span class="co"># marginal means</span></span></span>
<span class="r-in"><span>                                      sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span></span>
<span class="r-in"><span>                                      p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, <span class="co"># allocation, should sum to 1</span></span></span>
<span class="r-in"><span>                                      contrast.matrix <span class="op">=</span> <span class="va">contrast.matrix</span>,</span></span>
<span class="r-in"><span>                                      r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span></span>
<span class="r-in"><span>                                      k.covariates <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                      alpha <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                                      power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             SAMPLE SIZE CALCULATION              |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> One-way Analysis of Covariance (F-Test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : eta.squared = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : eta.squared &gt; 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total Sample Size      = 1245  &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 1 Error (alpha)   = 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 2 Error (beta)    = 0.199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Power      = 0.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># power of the planned contrasts</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ancova.contrasts.html">power.t.contrasts</a></span><span class="op">(</span><span class="va">ancova.design</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |                POWER CALCULATION                 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Analyses (T-Tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : psi = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : psi != 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contr   comparison    psi      d    ncp n.total power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1    A3 &lt;=&gt; A1  0.035  0.050  1.018    1245 0.174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2 A1 A3 &lt;=&gt; A2 -0.102 -0.144 -2.939    1245 0.836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################</span></span></span>
<span class="r-in"><span><span class="co">## custom contrasts ##</span></span></span>
<span class="r-in"><span><span class="co">######################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># custom contrasts</span></span></span>
<span class="r-in"><span><span class="va">contrast.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">1</span>, A2 <span class="op">=</span> <span class="op">-</span><span class="fl">0.50</span>, A3 <span class="op">=</span> <span class="op">-</span><span class="fl">0.50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">0.50</span>, A2 <span class="op">=</span> <span class="fl">0.50</span>, A3 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># labels are not required for custom contrasts,</span></span></span>
<span class="r-in"><span><span class="co"># but they make it easier to understand power.t.contrasts() output</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate sample size given design characteristics</span></span></span>
<span class="r-in"><span><span class="va">ancova.design</span> <span class="op">&lt;-</span> <span class="fu">power.f.ancova.shieh</span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span><span class="op">)</span>, <span class="co"># marginal means</span></span></span>
<span class="r-in"><span>                                      sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span></span>
<span class="r-in"><span>                                      p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, <span class="co"># allocation, should sum to 1</span></span></span>
<span class="r-in"><span>                                      contrast.matrix <span class="op">=</span> <span class="va">contrast.matrix</span>,</span></span>
<span class="r-in"><span>                                      r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span></span>
<span class="r-in"><span>                                      k.covariates <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                      alpha <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                                      power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             SAMPLE SIZE CALCULATION              |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> One-way Analysis of Covariance (F-Test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : eta.squared = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : eta.squared &gt; 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total Sample Size      = 1245  &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 1 Error (alpha)   = 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 2 Error (beta)    = 0.199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Power      = 0.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># power of the planned contrasts</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ancova.contrasts.html">power.t.contrasts</a></span><span class="op">(</span><span class="va">ancova.design</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |                POWER CALCULATION                 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Analyses (T-Tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : psi = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : psi != 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contr   comparison    psi      d    ncp n.total power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1 A1 &lt;=&gt; A2 A3 -0.100 -0.141 -2.351    1245 0.652</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2 A1 A2 &lt;=&gt; A3  0.025  0.035  0.588    1245 0.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Metin Bulus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

