<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Power Analysis for One-Way ANOVA/ANCOVA Using Means and Standard Deviations (F test) — power.f.ancova.keppel • pwrss</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power Analysis for One-Way ANOVA/ANCOVA Using Means and Standard Deviations (F test) — power.f.ancova.keppel"><meta name="description" content="Calculates power or sample size for one-way ANOVA/ANCOVA. Set k.cov = 0 for one-way ANOVA (without any pretest or covariate adjustment). Set k.cov &amp;gt; 0 in combination with  r2 &amp;gt; 0 for one-way ANCOVA (with pretest or covariate adjustment).
Note that R has a partial matching feature which allows you to specify shortened versions of arguments, such as mu or mu.vec instead of mu.vector, or such as k or k.cov instead of k.covariates.
Formulas are validated using PASS documentation."><meta property="og:description" content="Calculates power or sample size for one-way ANOVA/ANCOVA. Set k.cov = 0 for one-way ANOVA (without any pretest or covariate adjustment). Set k.cov &amp;gt; 0 in combination with  r2 &amp;gt; 0 for one-way ANCOVA (with pretest or covariate adjustment).
Note that R has a partial matching feature which allows you to specify shortened versions of arguments, such as mu or mu.vec instead of mu.vector, or such as k or k.cov instead of k.covariates.
Formulas are validated using PASS documentation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pwrss</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/examples.html">Practical Power Analysis in R</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/metinbulus/pwrss/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Power Analysis for One-Way ANOVA/ANCOVA Using Means and Standard Deviations (F test)</h1>

      <div class="d-none name"><code>ancova.keppel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates power or sample size for one-way ANOVA/ANCOVA. Set <code>k.cov = 0</code> for one-way ANOVA (without any pretest or covariate adjustment). Set <code>k.cov &gt; 0</code> in combination with  <code>r2 &gt; 0</code> for one-way ANCOVA (with pretest or covariate adjustment).</p>
<p>Note that R has a partial matching feature which allows you to specify shortened versions of arguments, such as <code>mu</code> or <code>mu.vec</code> instead of <code>mu.vector</code>, or such as <code>k</code> or <code>k.cov</code> instead of <code>k.covariates</code>.</p>
<p>Formulas are validated using PASS documentation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">power.f.ancova.keppel</span><span class="op">(</span><span class="va">mu.vector</span>, <span class="va">sd.vector</span>,</span>
<span>                      n.vector <span class="op">=</span> <span class="cn">NULL</span>, p.vector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                      factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mu.vector</span><span class="op">)</span>,</span>
<span>                      r.squared <span class="op">=</span> <span class="fl">0</span>, k.covariates <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                      power <span class="op">=</span> <span class="cn">NULL</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                      ceiling <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      pretty <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-mu-vector">mu.vector<a class="anchor" aria-label="anchor" href="#arg-mu-vector"></a></dt>
<dd><p>vector of adjusted means (or estimated marginal means) for each level of a factor.</p></dd>

  <dt id="arg-sd-vector">sd.vector<a class="anchor" aria-label="anchor" href="#arg-sd-vector"></a></dt>
<dd><p>vector of unadjusted standard deviations for each level of a factor.</p></dd>

  <dt id="arg-n-vector">n.vector<a class="anchor" aria-label="anchor" href="#arg-n-vector"></a></dt>
<dd><p>vector of sample sizes for each level of a factor.</p></dd>

  <dt id="arg-p-vector">p.vector<a class="anchor" aria-label="anchor" href="#arg-p-vector"></a></dt>
<dd><p>vector of proportion of total sample size in each level of a factor. These proportions should sum to one.</p></dd>

  <dt id="arg-factor-levels">factor.levels<a class="anchor" aria-label="anchor" href="#arg-factor-levels"></a></dt>
<dd><p>integer; number of levels or groups in each factor. For example, for two factors each having two levels or groups use e.g. c(2, 2), for three factors each having two levels or groups use e.g. c(2, 2, 2)</p></dd>

  <dt id="arg-r-squared">r.squared<a class="anchor" aria-label="anchor" href="#arg-r-squared"></a></dt>
<dd><p>explanatory power of covariates (R-squared) in the ANCOVA model. The default is <code>r.squared = 0</code>, which means an ANOVA model would be of interest.</p></dd>

  <dt id="arg-k-covariates">k.covariates<a class="anchor" aria-label="anchor" href="#arg-k-covariates"></a></dt>
<dd><p>integer; number of covariates in the ANCOVA model. The default is <code>k.cov = 0</code>, which means an ANOVA model would be of interest.</p></dd>

  <dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>statistical power, defined as the probability of correctly rejecting a false null hypothesis, denoted as \(1 - \beta\).</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>type 1 error rate, defined as the probability of incorrectly rejecting a true null hypothesis, denoted as \(\alpha\).</p></dd>

  <dt id="arg-ceiling">ceiling<a class="anchor" aria-label="anchor" href="#arg-ceiling"></a></dt>
<dd><p>logical; whether sample size should be rounded up. <code>TRUE</code> by default.</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical; whether the output should be printed on the console. <code>TRUE</code> by default.</p></dd>

  <dt id="arg-pretty">pretty<a class="anchor" aria-label="anchor" href="#arg-pretty"></a></dt>
<dd><p>logical; whether the output should show Unicode characters (if encoding allows for it). <code>FALSE</code> by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<dl><dt>parms</dt>
<dd><p>list of parameters used in calculation.</p></dd>

  <dt>test</dt>
<dd><p>type of the statistical test (F-Test).</p></dd>

  <dt>df1</dt>
<dd><p>numerator degrees of freedom.</p></dd>

  <dt>df2</dt>
<dd><p>denominator degrees of freedom.</p></dd>

  <dt>ncp</dt>
<dd><p>non-centrality parameter under alternative.</p></dd>

  <dt>null.ncp</dt>
<dd><p>non-centrality parameter under null.</p></dd>

  <dt>power</dt>
<dd><p>statistical power \((1-\beta)\).</p></dd>

  <dt>n.total</dt>
<dd><p>total sample size.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Keppel, G., &amp; Wickens, T. D. (2004). Design and analysis: A researcher's handbook (4th ed.). Pearson.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># required sample size to detect a mean difference of</span></span></span>
<span class="r-in"><span><span class="co"># Cohen's d = 0.50 for a one-way two-group design</span></span></span>
<span class="r-in"><span><span class="fu">power.f.ancova.keppel</span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># marginal means</span></span></span>
<span class="r-in"><span>                      sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span></span>
<span class="r-in"><span>                      n.vector <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># sample size (will be calculated)</span></span></span>
<span class="r-in"><span>                      p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.50</span><span class="op">)</span>, <span class="co"># balanced allocation</span></span></span>
<span class="r-in"><span>                      k.cov <span class="op">=</span> <span class="fl">1</span>, <span class="co"># number of covariates</span></span></span>
<span class="r-in"><span>                      r.squared <span class="op">=</span> <span class="fl">0.50</span>, <span class="co"># explanatory power of covariates</span></span></span>
<span class="r-in"><span>                      alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># Type 1 error rate</span></span></span>
<span class="r-in"><span>                      power <span class="op">=</span> <span class="fl">.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             SAMPLE SIZE CALCULATION              |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> One-way Analysis of Covariance (F-Test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : eta.squared = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : eta.squared &gt; 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total Sample Size      = 66  &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 1 Error (alpha)   = 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 2 Error (beta)    = 0.193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Power      = 0.807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># effect size approach</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ancova.html">power.f.ancova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.111</span>, <span class="co"># effect size that is already adjusted for covariates</span></span></span>
<span class="r-in"><span>               factor.levels <span class="op">=</span> <span class="fl">2</span>, <span class="co"># one-way ANCOVA with two levels (groups)</span></span></span>
<span class="r-in"><span>               k.covariates <span class="op">=</span> <span class="fl">1</span>, <span class="co"># number of covariates</span></span></span>
<span class="r-in"><span>               alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># Type 1 error rate</span></span></span>
<span class="r-in"><span>               power <span class="op">=</span> <span class="fl">.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             SAMPLE SIZE CALCULATION              |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> One-way Analysis of Covariance (F-Test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : eta.squared = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : eta.squared &gt; 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total Sample Size      = 66  &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 1 Error (alpha)   = 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 2 Error (beta)    = 0.193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Power      = 0.807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># regression approach</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.50</span></span></span>
<span class="r-in"><span><span class="fu"><a href="regression.linear.t.html">power.t.regression</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">0.50</span>,</span></span>
<span class="r-in"><span>                   sd.predictor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   sd.outcome <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   k.total <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span></span>
<span class="r-in"><span>                   n <span class="op">=</span> <span class="cn">NULL</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             SAMPLE SIZE CALCULATION              |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear Regression Coefficient (T-Test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null Claim) : beta - null.beta = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alt. Claim) : beta - null.beta != 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sample Size            = 65  &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 1 Error (alpha)   = 0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type 2 Error           = 0.199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Power      = 0.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Metin Bulus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

