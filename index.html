<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Statistical Power and Sample Size Calculation Tools • pwrss</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Statistical Power and Sample Size Calculation Tools">
<meta name="description" content="The pwrss R package provides flexible and comprehensive functions for statistical power and minimum required sample size calculations across a wide range of commonly used hypothesis tests in psychological, biomedical, and social sciences.">
<meta property="og:description" content="The pwrss R package provides flexible and comprehensive functions for statistical power and minimum required sample size calculations across a wide range of commonly used hypothesis tests in psychological, biomedical, and social sciences.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">pwrss</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/examples.html">Practical Power Analysis in R</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/metinbulus/pwrss/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="pwrss-">pwrss <a href="https://metinbulus.github.io/pwrss/"><img src="reference/figures/hex.png" align="right" width="20%" alt="Package Logo"></a>
<a class="anchor" aria-label="anchor" href="#pwrss-"></a>
</h1></div>
<p><br clear="all"></p>
<!-- badges: start -->

<!---
[//]: [![Build Status](https://app.travis-ci.com/metinbulus/pwrss.svg?branch=main)](https://app.travis-ci.com/metinbulus/pwrss)
--->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
&#10;  gtag('config', 'G-047X5R7P7R');
</script><style type="text/css">
div.tocify {
  width: 30%;
  max-width: 260px;
  max-height: 100%;
}
&#10;.tocify ul, .tocify li {
  line-height: 20px;
}
&#10;.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 35px;
  text-indent: 0;
}
&#10;.tocify-subheader .tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 70px;
  text-indent: 0;
}
</style>
<div style="background-color:rgb(255, 165, 90); padding: 20px 20px 1px; border-radius:5px;">
<p>
The original tutorial was published on CRAN and can be accessed at: <a href="https://cran.rstudio.com/web/packages/pwrss/vignettes/examples.html" class="external-link">https://cran.rstudio.com/web/packages/pwrss/vignettes/examples.html</a>
</p>
</div>
<p><br></p>
<p>Install and load pwrss R package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pwrss"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://metinbulus.github.io/pwrss">pwrss</a></span><span class="op">)</span></span></code></pre></div>
<p>If you find the package and related material useful please cite as:</p>
<div style="background-color:rgb(245, 245, 245); padding: 20px 20px 1px; border-radius:5px;">
<p>
Bulus, M., &amp; Jentschke, S. (2025). pwrss: Statistical Power and Sample Size Calculation Tools. R package version 1.0.0. <a href="https://doi.org/10.32614/CRAN.package.pwrss" class="external-link uri">https://doi.org/10.32614/CRAN.package.pwrss</a>
</p>
</div>
<p><strong>Acknowledgments</strong></p>
<p>This open-source project has benefited from users who have taken the time to report typos and identify bugs. I would like to acknowledge those who have helped improve the accuracy and quality of the project by reporting these issues. If I have missed anyone who has provided similar feedback, please let me know.</p>
<p>Error reports from (alphabetic order): <br> Adrian Olszewski (bug report); Catherine (Kate) Crespi (bug report); dpnichols811 (GitHub profile) (bug report); Fred Oswald (typo report); Jarrod Hadfield (bug report); Leszek Gawarecki (typo report); Roland Thijs (typo report)</p>
<p>Please send any bug reports, feedback, or questions to <a href="mailto:bulusmetin@gmail.com">bulusmetin [at] gmail.com</a></p>
<p><br></p>
</div>
<div class="section level1">
<h1 id="generic">Generic<a class="anchor" aria-label="anchor" href="#generic"></a>
</h1>
<hr>
<p>These generic functions compute and return statistical power with the option to generate Type I and Type II error plots when test statistics and degrees of freedom are available. Users can input test statistics manually, valuable for custom designs outside the {pwrss} package’s scope, or extract them from statistical software output. This flexibility proves particularly advantageous since test statistics and degrees of freedom are typically accessible from programs like jamovi, JASP, SAS, SPSS, or Stata.</p>
<p>Power calculations can be performed by entering the test statistic through the ncp or mean arguments. Post-hoc power estimates derived this way provide a sensitivity analysis, revealing the evidential strength of a study’s sample size relative to the observed effect size. This approach offers valuable insights for large samples, where effect estimates demonstrate greater stability. However, for small samples, where effect size estimates exhibit higher variability, post-hoc power requires cautious interpretation.</p>
<div class="section level2">
<h2 id="t-test">T-Test<a class="anchor" aria-label="anchor" href="#t-test"></a>
</h2>
<div class="section level3">
<h3 id="post-hoc">Post-Hoc<a class="anchor" aria-label="anchor" href="#post-hoc"></a>
</h3>
<p><strong>Example</strong>: The <code>mtcars</code> dataset in R that contains information about 32 car models from the 1974 issue of Motor Trend magazine and includes various performance and design attributes for each vehicle. The variables of interest:</p>
<ul>
<li>
<code>mpg</code> : Miles per gallon</li>
<li>
<code>hp</code> : Gross horsepower</li>
<li>
<code>wt</code> : Weight of the car (in 1000 lbs unit)</li>
</ul>
<p>We aim to estimate the extent to which a one-unit increase in gross horsepower is associated with miles per gallon, while controlling for vehicle weight. What is the post-hoc power given the observed test statistic?</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = mpg ~ hp + wt, data = mtcars)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -3.941 -1.600 -0.182  1.050  5.854 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 37.22727    1.59879  23.285  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; hp          -0.03177    0.00903  -3.519  0.00145 ** </span></span>
<span><span class="co">#&gt; wt          -3.87783    0.63273  -6.129 1.12e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.593 on 29 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8268, Adjusted R-squared:  0.8148 </span></span>
<span><span class="co">#&gt; F-statistic: 69.21 on 2 and 29 DF,  p-value: 9.109e-12</span></span>
<span></span>
<span><span class="fu"><a href="reference/generic.t.test.html">power.t.test</a></span><span class="op">(</span>ncp <span class="op">=</span> <span class="op">-</span><span class="fl">3.519</span>, <span class="co"># t-value for hp variable</span></span>
<span>             df <span class="op">=</span> <span class="fl">29</span>, <span class="co"># residual degrees of freedom</span></span>
<span>             alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># type 1 error rate</span></span>
<span>             alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Generic T-Test</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; Hypotheses</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;   H0 (Null Claim) : ncp = null.ncp </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;   H1 (Alt. Claim) : ncp != null.ncp </span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; Results</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt;   Type 2 Error (beta)    = 0.075</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt;   Statistical Power      = 0.925  &lt;&lt;</span></span></code></pre></div>
<p><strong>Report</strong>: The post-hoc power analysis showed that a sample of 32 cars had a 0.925 chance of detecting the observed relationship between horsepower and miles per gallon, if such a relationship exists. The analysis was conducted using an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> level of 0.05.</p>
</div>
<div class="section level3">
<h3 id="user-defined-design">User-Defined Design<a class="anchor" aria-label="anchor" href="#user-defined-design"></a>
</h3>
<p>Power calculation is not readily available for non-equivalent pre-test vs. post-test control-group-designs but the formula is already known. The approximate standard error is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>E</mi><mo>=</mo><msqrt><mfrac><mrow><mn>1</mn><mo>−</mo><msup><mi>R</mi><mn>2</mn></msup></mrow><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>R</mi><mrow><mi>T</mi><mi>X</mi></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt></mrow><annotation encoding="application/x-tex">SE = \sqrt{\frac{1 - R^2}{p(1 - p)n(1 - R^2_{TX})}}</annotation></semantics></math></p>
<p>with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi><mo>=</mo><mi>n</mi><mo>−</mo><mi>g</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">df = n - g - 2</annotation></semantics></math> where</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math> : Explanatory power of covariates</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mrow><mi>T</mi><mi>X</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">R^2_{TX}</annotation></semantics></math> : Squared point-biserial correlation between treatment indicator and pre-test</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math> : Group allocation rate</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> : Total sample size</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math> : Number of covariates</li>
</ul>
<p>For details please see (<a href="https://dergipark.org.tr/tr/download/article-file/1783497" target="_blank" class="external-link">Bulus</a>, 2021, p. 52; <a href="https://doi.org/10.1177%2F0193841X0102500101" target="_blank" class="external-link">Oakes and Feldman</a>, 2001, p. 15).</p>
<p><strong>Example</strong>: A team of educational psychologists implements a mindfulness-based stress-reduction program in 6th-grade classrooms at one middle school, while 6th-grade classrooms at another school continue with their usual homeroom activities (the conventional approach). They want to determine whether the new program yields greater improvements in emotional regulation by comparing students in the intervention school with those in the control school. All students complete a standardized emotional-regulation inventory at both the start and the end of the semester.</p>
<p>A superiority test will be conducted to assess whether improvements in the intervention school exceed those in the control school by a meaningful margin. The researcher considers a medium effect relevant and sufficient support for potential scale-up (<code>d = 0.50</code>) and defines the superiority margin as 0.10 - that is, the mindfulness program will be considered superior to the conventional program if the <code>d - null.d</code> is at least 0.10.</p>
<p>Assume there are two classrooms in each school, each classroom has 30 students, the pre-test accounts for 50% of the variance in post-test scores, and the squared point-biserial correlation between group membership and emotional regulation scores is 0.10. What is the power to detect superiority under these criteria?</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define parameters</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">0.50</span> <span class="co"># effect size under alternative</span></span>
<span><span class="va">null.d</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># effect size under null</span></span>
<span><span class="va">margin</span> <span class="op">&lt;-</span> <span class="fl">0.10</span> <span class="co"># smallest meaningful diff between d and null.d</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.50</span> <span class="co"># proportion of subjects in the intervention school</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">120</span> <span class="co"># total sample size</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># number of covariates</span></span>
<span><span class="va">r.squared</span> <span class="op">&lt;-</span> <span class="fl">0.50</span> <span class="co"># explanatory power of covariates</span></span>
<span><span class="va">rtx.squared</span> <span class="op">&lt;-</span> <span class="fl">0.10</span> <span class="co"># squared point-biserial cor between trt dummy and outcome</span></span>
<span></span>
<span><span class="co"># calculate the standard error</span></span>
<span><span class="va">std.error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r.squared</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span> <span class="op">*</span> <span class="va">n</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rtx.squared</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate non-centrality parameters</span></span>
<span><span class="va">ncp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">d</span> <span class="op">-</span> <span class="va">null.d</span><span class="op">)</span> <span class="op">/</span> <span class="va">std.error</span></span>
<span><span class="va">null.ncp</span> <span class="op">&lt;-</span> <span class="va">margin</span> <span class="op">/</span> <span class="va">std.error</span></span>
<span></span>
<span><span class="co"># calculate power</span></span>
<span><span class="fu"><a href="reference/generic.t.test.html">power.t.test</a></span><span class="op">(</span>ncp <span class="op">=</span> <span class="va">ncp</span>,</span>
<span>             null.ncp <span class="op">=</span> <span class="va">null.ncp</span>,</span>
<span>             df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="va">g</span> <span class="op">-</span> <span class="fl">2</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>             alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>             plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generic T-Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : ncp &lt;= null.ncp </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : ncp &gt; null.ncp </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.104</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.896  &lt;&lt;</span></span></code></pre></div>
<p><strong>Report</strong>: A power analysis was conducted to assess whether a sample of 120 students would be sufficient to detect the effect of a mindfulness intervention on emotional regulation. The analysis targeted a moderate effect size (d = 0.50) with a superiority margin of 0.10, using a one-tailed test at <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05. This design yielded an estimated power of 0.90, indicating adequate sensitivity to detect the intervention effect.</p>
</div>
</div>
<div class="section level2">
<h2 id="z-test">Z-Test<a class="anchor" aria-label="anchor" href="#z-test"></a>
</h2>
<div class="section level3">
<h3 id="post-hoc-1">Post-Hoc<a class="anchor" aria-label="anchor" href="#post-hoc-1"></a>
</h3>
<p><strong>Example</strong>: The <code>warpbreaks</code> dataset in R contains data from an experiment on the number of warp breaks per loom in a fixed length of yarn. It includes information on the type of wool and tension level used during weaving. The dataset is often used to illustrate count data modeling. The variables of interest:</p>
<ul>
<li>
<code>breaks</code>: Number of warp breaks</li>
<li>
<code>wool</code>: Type of wool (factor with levels A and B)</li>
<li>
<code>tension</code>: Tension applied to the yarn (factor with levels Low, Medium, High)</li>
</ul>
<p>We aim to estimate the extent to which the type of wool and the level of tension are associated with the number of warp breaks using a Poisson regression model. What is the post-hoc power given the observed test statistic for Wool B?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">warpbreaks</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">breaks</span> <span class="op">~</span> <span class="va">wool</span> <span class="op">+</span> <span class="va">tension</span>, data <span class="op">=</span> <span class="va">warpbreaks</span>,</span>
<span>             family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = breaks ~ wool + tension, family = poisson(link = "log"), </span></span>
<span><span class="co">#&gt;     data = warpbreaks)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)  3.69196    0.04541  81.302  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; woolB       -0.20599    0.05157  -3.994 6.49e-05 ***</span></span>
<span><span class="co">#&gt; tensionM    -0.32132    0.06027  -5.332 9.73e-08 ***</span></span>
<span><span class="co">#&gt; tensionH    -0.51849    0.06396  -8.107 5.21e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for poisson family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 297.37  on 53  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 210.39  on 50  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 493.06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span></span>
<span><span class="fu"><a href="reference/generic.z.test.html">power.z.test</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="op">-</span><span class="fl">3.994</span>, <span class="co"># z-value for wool B</span></span>
<span>             alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># type 1 error rate</span></span>
<span>             alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; Generic Z-Test</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; Hypotheses</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;   H0 (Null Claim) : mean = null.mean </span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt;   H1 (Alt. Claim) : mean != null.mean </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; Results</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt;   Type 2 Error (beta)  = 0.021</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt;   Statistical Power    = 0.979  &lt;&lt;</span></span></code></pre></div>
<p><strong>Report</strong>: The post-hoc power analysis showed that a sample of 54 trials had a 0.979 chance of detecting the observed relationship between Wool B and number of warp breaks, if such a relationship exists. The analysis was conducted using an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> level of 0.05.</p>
</div>
<div class="section level3">
<h3 id="user-defined-design-1">User Defined Design<a class="anchor" aria-label="anchor" href="#user-defined-design-1"></a>
</h3>
<p>Power calculation is not readily available for Spearman’s <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math> rank correlation but the formula is already known. The approximate standard error for the Fisher’s Z-transformed correlation coefficient is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>E</mi><mo>=</mo><msqrt><mfrac><mn>1.06</mn><mrow><mi>n</mi><mo>−</mo><mn>3</mn></mrow></mfrac></msqrt></mrow><annotation encoding="application/x-tex">SE = \sqrt{\frac{1.06}{n - 3}}</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> is the sample size. For details please see (<a href="https://doi.org/10.1093/biomet/44.3-4.470" target="_blank" class="external-link">Fieller, Hartley, and Pearson</a>, 1957, p. 472).</p>
<p><strong>Example</strong>: A team of school counselors want to examine whether there is a relationship between students’ class rank (1st, 2nd, 3rd, etc.) and their self-reported academic stress levels, measured on a 10-point scale (1 = no stress, 10 = extreme stress). Since class rank is an ordinal variable (lower ranks mean higher academic standing) and the stress scale is subjective and potentially not interval-scaled, the counselor uses Spearman’s rank-order correlation (Spearman’s <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>) to assess whether higher-ranking students tend to report lower or higher levels of stress.</p>
<p>Researchers hypothesize that students with higher class ranks (i.e., lower rank numbers) report lower stress levels. They plan to recruit 100 students, interested in detecting a Spearman’s <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math> as small as 0.30, and will use a two-tailed test with an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> level of 0.05. What is the power under these criteria?</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define parameters</span></span>
<span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fl">0.30</span> <span class="co"># spearman rho rank cor under alternative</span></span>
<span><span class="va">null.rs</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># spearman rho rank cor under null</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># sample size</span></span>
<span></span>
<span><span class="co"># apply Fisher's Z transformation</span></span>
<span><span class="va">z.rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/conversion.cors.to.q.html">cor.to.z</a></span><span class="op">(</span><span class="va">rs</span><span class="op">)</span><span class="op">$</span><span class="va">z</span></span>
<span><span class="co">#&gt;         z       rho </span></span>
<span><span class="co">#&gt; 0.3095196 0.3000000</span></span>
<span><span class="va">z.null.rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/conversion.cors.to.q.html">cor.to.z</a></span><span class="op">(</span><span class="va">null.rs</span><span class="op">)</span><span class="op">$</span><span class="va">z</span></span>
<span><span class="co">#&gt;   z rho </span></span>
<span><span class="co">#&gt;   0   0</span></span>
<span></span>
<span><span class="co"># calculate the standard error</span></span>
<span><span class="va">z.std.error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1.06</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate the non-centrality parameter</span></span>
<span><span class="va">ncp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">z.rs</span> <span class="op">-</span> <span class="va">z.null.rs</span><span class="op">)</span> <span class="op">/</span> <span class="va">z.std.error</span></span>
<span></span>
<span><span class="co"># calculate power</span></span>
<span><span class="fu"><a href="reference/generic.z.test.html">power.z.test</a></span><span class="op">(</span>ncp <span class="op">=</span> <span class="va">ncp</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>             alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; Generic Z-Test</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Hypotheses</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt;   H0 (Null Claim) : mean = null.mean </span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt;   H1 (Alt. Claim) : mean != null.mean </span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Results</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt;   Type 2 Error (beta)  = 0.158</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;   Statistical Power    = 0.842  &lt;&lt;</span></span></code></pre></div>
<p><strong>Report</strong>: A power analysis was conducted to assess whether 100 students are sufficient to detect association between students’ class rank and their self-reported academic stress levels. The analysis targeted a moderate Spearman’s <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math> of 0.30, a two-tailed test with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05. This configuration yielded an estimated power of 0.84, indicating sufficient sensitivity to detect the hypothesized association.</p>
</div>
</div>
<div class="section level2">
<h2 id="f-test">F-Test<a class="anchor" aria-label="anchor" href="#f-test"></a>
</h2>
<div class="section level3">
<h3 id="post-hoc-2">Post-Hoc<a class="anchor" aria-label="anchor" href="#post-hoc-2"></a>
</h3>
<p><strong>Example</strong>: The <code>trees</code> dataset in R contains measurements of the volume, height, and girth (diameter) of 31 black cherry trees. The variables of interest:</p>
<ul>
<li>
<code>Girth</code>: Diameter of the tree (in inches)</li>
<li>
<code>Height</code>: Height of the tree (in feet)</li>
</ul>
<p>We aim to estimate the extent to which the tree height is associated with the tree girth. What is the post-hoc power given the observed test statistic?</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># model &lt;- aov(Girth ~ Height, data = trees)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Girth</span> <span class="op">~</span> <span class="va">Height</span>, data <span class="op">=</span> <span class="va">trees</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Girth ~ Height, data = trees)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -4.2386 -1.9205 -0.0714  2.7450  4.5384 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept) -6.18839    5.96020  -1.038  0.30772   </span></span>
<span><span class="co">#&gt; Height       0.25575    0.07816   3.272  0.00276 **</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.728 on 29 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.2697, Adjusted R-squared:  0.2445 </span></span>
<span><span class="co">#&gt; F-statistic: 10.71 on 1 and 29 DF,  p-value: 0.002758</span></span>
<span></span>
<span><span class="fu"><a href="reference/generic.f.test.html">power.f.test</a></span><span class="op">(</span>ncp <span class="op">=</span> <span class="fl">10.71</span>, <span class="co"># non-centrality under alternative</span></span>
<span>             df1 <span class="op">=</span> <span class="fl">1</span>, <span class="co"># numerator degrees of freedom</span></span>
<span>             df2 <span class="op">=</span> <span class="fl">29</span>, <span class="co"># denominator degrees of freedom</span></span>
<span>             alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># type 1 error rate</span></span>
<span>             plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generic F-Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : ncp = null.ncp </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : ncp &gt; null.ncp </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.115</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.885  &lt;&lt;</span></span></code></pre></div>
<p><strong>Report</strong>: The post-hoc power analysis showed that a sample of 31 trees had a 0.885 chance of detecting the observed relationship between tree height and girth, if such a relationship exists in the population. The analysis was conducted using an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> level of 0.05.</p>
</div>
</div>
<div class="section level2">
<h2 id="chi-square-test">Chi-square Test<a class="anchor" aria-label="anchor" href="#chi-square-test"></a>
</h2>
<div class="section level3">
<h3 id="post-hoc-1-1">Post-Hoc 1<a class="anchor" aria-label="anchor" href="#post-hoc-1-1"></a>
</h3>
<p><strong>Example</strong>: The <code>HairEyeColor</code> dataset in R contains data from a survey of 592 students, recording the joint distribution of hair color, eye color, and gender. It is stored as a three-dimensional contingency table, with counts representing the number of individuals in each category. The variables of interest:</p>
<ul>
<li>
<code>Hair</code>: Hair color (e.g., Black, Brown, Blond, Red)</li>
<li>
<code>Eye</code>: Eye color (e.g., Brown, Blue, Hazel, Green)</li>
</ul>
<p>We aim to examine the association between hair color and eye color. What is the post-hoc power given the observed test statistic from a chi-squared test of independence?</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/marginSums.html" class="external-link">margin.table</a></span><span class="op">(</span><span class="va">HairEyeColor</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel Green</span></span>
<span><span class="co">#&gt;   Black    68   20    15     5</span></span>
<span><span class="co">#&gt;   Brown   119   84    54    29</span></span>
<span><span class="co">#&gt;   Red      26   17    14    14</span></span>
<span><span class="co">#&gt;   Blond     7   94    10    16</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's Chi-squared test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  table</span></span>
<span><span class="co">#&gt; X-squared = 138.29, df = 9, p-value &lt; 2.2e-16</span></span>
<span></span>
<span><span class="fu"><a href="reference/generic.chisq.test.html">power.chisq.test</a></span><span class="op">(</span>ncp <span class="op">=</span> <span class="fl">138.29</span>, <span class="co"># X-squared</span></span>
<span>                 df <span class="op">=</span> <span class="fl">9</span>, <span class="co"># degrees of freedom</span></span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># type 1 error rate</span></span>
<span>                 plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generic Chi-square Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : ncp = null.ncp </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : ncp &gt; null.ncp </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.000</span></span>
<span><span class="co">#&gt;   Statistical Power      = 1  &lt;&lt;</span></span></code></pre></div>
<p><strong>Report</strong>: The post-hoc power analysis showed that a sample of 592 individuals had a 1.00 chance of detecting the observed relationship between hair and eye color, if such a relationship exists in the population. The analysis was conducted using an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> level of 0.05.</p>
</div>
<div class="section level3">
<h3 id="post-hoc-2-1">Post-Hoc 2<a class="anchor" aria-label="anchor" href="#post-hoc-2-1"></a>
</h3>
<p><strong>Example</strong>: The <code>infert</code> dataset in R contains data from a study on infertility in women, examining the relationship between reproductive history and infertility status. It includes demographic and clinical information on 248 women. The variables of interest:</p>
<ul>
<li>
<code>case</code>: Infertility status (1 = infertile, 0 = fertile)</li>
<li>
<code>age</code>: Age of woman in years</li>
<li>
<code>parity</code>: Number of prior full-term pregnancies</li>
<li>
<code>induced</code>: Number of induced abortions</li>
<li>
<code>spontaneous</code>: Number of spontaneous abortions</li>
</ul>
<p>We aim to evaluate whether the number of induced abortions contributes to the prediction of infertility status, beyond the effects of age, parity, and spontaneous abortions, using a logistic regression framework. What is the post-hoc power given the observed deviance difference between the full and reduced models?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">infert</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">parity</span> <span class="op">+</span> <span class="va">spontaneous</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">infert</span>,</span>
<span>                   family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">parity</span> <span class="op">+</span> <span class="va">spontaneous</span> <span class="op">+</span> <span class="va">induced</span>,</span>
<span>                data <span class="op">=</span> <span class="va">infert</span>,</span>
<span>                family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.reduced</span>, <span class="va">fit.full</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model 1: case ~ age + parity + spontaneous</span></span>
<span><span class="co">#&gt; Model 2: case ~ age + parity + spontaneous + induced</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span><span class="co">#&gt; 1       244     279.41                          </span></span>
<span><span class="co">#&gt; 2       243     260.94  1   18.463 1.732e-05 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="reference/generic.chisq.test.html">power.chisq.test</a></span><span class="op">(</span>ncp <span class="op">=</span> <span class="fl">18.463</span>,</span>
<span>                 df <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; Generic Chi-square Test</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; Hypotheses</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt;   H0 (Null Claim)   : ncp = null.ncp </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt;   H1 (Alt. Claim)   : ncp &gt; null.ncp </span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; Results</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt;   Type 2 Error (beta)    = 0.010</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt;   Statistical Power      = 0.99  &lt;&lt;</span></span></code></pre></div>
<p><strong>Report</strong>: The post-hoc power analysis indicated that a sample of 248 women provided a 0.99 probability of detecting the unique contribution of the number of induced abortions to infertility status, while controlling for other variables, assuming such a relationship exists in the population. The analysis was conducted using an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> level of 0.05.</p>
</div>
</div>
<div class="section level2">
<h2 id="binomial-test">Binomial Test<a class="anchor" aria-label="anchor" href="#binomial-test"></a>
</h2>
<div class="section level3">
<h3 id="post-hoc-3">Post-Hoc<a class="anchor" aria-label="anchor" href="#post-hoc-3"></a>
</h3>
<p><strong>Example</strong>: The <code>faithful</code> dataset contains 272 observations of eruptions of the Old Faithful geyser in Yellowstone National Park. It includes:</p>
<ul>
<li>
<code>eruptions</code>: Eruption duration (in minutes)</li>
<li>
<code>waiting</code>: Time between eruptions (in minutes)</li>
</ul>
<p>We aim to test whether eruptions lasting more than 3 minutes occur more than half the time. What is the post-hoc power given the observed proportion and sample size?</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span></span>
<span><span class="va">long</span> <span class="op">&lt;-</span> <span class="va">faithful</span><span class="op">$</span><span class="va">eruptions</span> <span class="op">&gt;</span> <span class="fl">3</span></span>
<span><span class="va">n.success</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">long</span><span class="op">)</span></span>
<span><span class="va">n.total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></span><span class="op">(</span><span class="va">n.success</span>, <span class="va">n.total</span>, p <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Exact binomial test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  n.success and n.total</span></span>
<span><span class="co">#&gt; number of successes = 175, number of trials = 272, p-value = 2.609e-06</span></span>
<span><span class="co">#&gt; alternative hypothesis: true probability of success is not equal to 0.5</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.5832982 0.7003038</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; probability of success </span></span>
<span><span class="co">#&gt;              0.6433824</span></span>
<span></span>
<span><span class="fu"><a href="reference/generic.binom.test.html">power.binom.test</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">n.total</span>, <span class="co"># number of eruptions</span></span>
<span>                 prob <span class="op">=</span> <span class="va">n.success</span> <span class="op">/</span> <span class="va">n.total</span>, <span class="co"># prob. of occurrence under alt.</span></span>
<span>                 null.prob <span class="op">=</span> <span class="fl">0.50</span>, <span class="co"># prob. of occurrence under null</span></span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                 plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; Generic Binomial Test</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; Hypotheses</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt;   H0 (Null Claim) : prob &lt;= null.prob </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt;   H1 (Alt. Claim) : prob &gt; null.prob </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; Results</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt;   Type 1 Error (alpha)   = 0.039</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt;   Type 2 Error (beta)    = 0.001</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt;   Statistical Power      = 0.999  &lt;&lt;</span></span></code></pre></div>
<p><strong>Report</strong>: The post-hoc power analysis indicated that a sample of 272 eruptions provided a 0.999 probability of detecting whether eruptions lasting more than 3 minutes occur more than 50% of the time, if it exists in the underlying eruption pattern. The analysis was based on a one-sided test procedure with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05.</p>
</div>
<div class="section level3">
<h3 id="user-defined-designs">User-Defined Designs<a class="anchor" aria-label="anchor" href="#user-defined-designs"></a>
</h3>
<p><strong>Example 1</strong>: Find number of coin toss to test whether a coin is fair.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># find the approximate solution</span></span>
<span><span class="fu"><a href="reference/proportions.oneprop.html">power.z.oneprop</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.50</span>, <span class="co"># prob. of head under alt.</span></span>
<span>                null.prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.495</span>, <span class="fl">0.505</span><span class="op">)</span>, <span class="co"># equivalence margins</span></span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># type 1 error rate</span></span>
<span>                alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">n</span></span>
<span><span class="co">#&gt; [1] 85639</span></span>
<span></span>
<span><span class="co"># iterate to find the exact solution</span></span>
<span><span class="fu"><a href="reference/generic.binom.test.html">power.binom.test</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">85632</span>, <span class="co"># number of tosses needed</span></span>
<span>                 prob <span class="op">=</span> <span class="fl">0.50</span>, <span class="co"># prob. of head under alt.</span></span>
<span>                 null.prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.495</span>, <span class="fl">0.505</span><span class="op">)</span>, <span class="co"># equivalence margins</span></span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># type 1 error rate</span></span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                 plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generic Binomial Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob &lt;= min(null.prob) or </span></span>
<span><span class="co">#&gt;                     prob &gt;= max(null.prob) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob &gt; min(null.prob) and </span></span>
<span><span class="co">#&gt;                     prob &lt; max(null.prob) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8  &lt;&lt;</span></span></code></pre></div>
<p><strong>Report 1</strong>: Power analysis indicated that at least 85,632 coin tosses are required to determine whether a coin is fair. The analysis assumes a fair coin has a 0.50 probability of landing heads, with equivalence margins set at 0.495 and 0.505, using a two one-sided test procedure with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05.</p>
<p><strong>Example 2</strong>: Find optimal number of replications in a Monte Carlo simulation.</p>
<p>To reliably detect a type 1 error rate of 0.05:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># find the approximate solution</span></span>
<span><span class="fu"><a href="reference/proportions.oneprop.html">power.z.oneprop</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># prob. of head under alt.</span></span>
<span>                null.prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.045</span>, <span class="fl">0.055</span><span class="op">)</span>, <span class="co"># equivalence margins</span></span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># type 1 error rate</span></span>
<span>                alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">n</span></span>
<span><span class="co">#&gt; [1] 16272</span></span>
<span></span>
<span><span class="co"># iterate to find the exact solution</span></span>
<span><span class="fu"><a href="reference/generic.binom.test.html">power.binom.test</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16424</span>, <span class="co"># number of replications needed</span></span>
<span>                 prob <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># prob. of falsely rejecting null</span></span>
<span>                 null.prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.045</span>, <span class="fl">0.055</span><span class="op">)</span>, <span class="co"># equivalence margins</span></span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                 plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generic Binomial Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob &lt;= min(null.prob) or </span></span>
<span><span class="co">#&gt;                     prob &gt;= max(null.prob) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob &gt; min(null.prob) and </span></span>
<span><span class="co">#&gt;                     prob &lt; max(null.prob) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.049</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.198</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.802  &lt;&lt;</span></span></code></pre></div>
<p>To reliably detect a power rate of 0.80:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># find the approximate solution</span></span>
<span><span class="fu"><a href="reference/proportions.oneprop.html">power.z.oneprop</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.80</span>, <span class="co"># prob. of correctly rejecting null</span></span>
<span>                null.prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.795</span>, <span class="fl">0.805</span><span class="op">)</span>, <span class="co"># equivalence margins</span></span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># type 1 error rate</span></span>
<span>                alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">n</span></span>
<span><span class="co">#&gt; [1] 54809</span></span>
<span></span>
<span><span class="co"># iterate to find the exact solution</span></span>
<span><span class="fu"><a href="reference/generic.binom.test.html">power.binom.test</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">55011</span>, <span class="co"># number of replications needed</span></span>
<span>                 prob <span class="op">=</span> <span class="fl">0.80</span>, <span class="co"># prob. of correctly rejecting null</span></span>
<span>                 null.prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.795</span>, <span class="fl">0.805</span><span class="op">)</span>, <span class="co"># equivalence margins</span></span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                 plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generic Binomial Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob &lt;= min(null.prob) or </span></span>
<span><span class="co">#&gt;                     prob &gt;= max(null.prob) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob &gt; min(null.prob) and </span></span>
<span><span class="co">#&gt;                     prob &lt; max(null.prob) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801  &lt;&lt;</span></span></code></pre></div>
<p><strong>Report 2</strong>: Power analysis indicated that at least 16,424 replications are required to estimate the Type 1 error rate at <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05. This analysis used a two one-sided test procedure with equivalence margins set at 0.045 and 0.055. In contrast, at least 55,011 replications are needed to estimate statistical power at 0.80, assuming equivalence margins of 0.795 and 0.805, also using the two one-sided test procedure with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05.</p>
</div>
</div>
<div class="section level2">
<h2 id="error-plots">Error Plots<a class="anchor" aria-label="anchor" href="#error-plots"></a>
</h2>
<p><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function (S3 method) is a wrapper around the generic functions above. It creates a visual representation of both null and alternative distributions, with shaded areas indicating Type 1 error (false positive) and Type 2 error (false negative) regions.</p>
<p>Assign results of any <code>pwrss</code> function to an R object and pass it to the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-20-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>NOTE: In earlier versions of the {pwrss} package, the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function generated multiple panel plots for ANCOVA designs and mediation models. This feature is no longer supported, as the updated functions now return one effect at a time.</p>
<p><br><br></p>
</div>
</div>
<div class="section level1">
<h1 id="means-t-test">Means (T-Test)<a class="anchor" aria-label="anchor" href="#means-t-test"></a>
</h1>
<hr>
<div class="section level2">
<h2 id="independent-samples-t-test">Independent Samples T-Test<a class="anchor" aria-label="anchor" href="#independent-samples-t-test"></a>
</h2>
<p>An independent samples t-test is used to compare the mean outcomes of two groups that are statistically independent - meaning the outcome value of an individual in one group is not related to the outcome value of an individual in the other group. These groups may represent treatment and control conditions, gender groups (e.g., females and males), or any other pre-existing or experimentally assigned categories.</p>
<div class="section level3">
<h3 id="parametric">Parametric<a class="anchor" aria-label="anchor" href="#parametric"></a>
</h3>
<p><strong>Example</strong>: Suppose we aim to evaluate the extent to which a psychological intervention reduces post-earthquake psychosomatic symptoms. We consider a standardized mean difference as small as Cohen’s d = -0.20 between the treatment and control groups to be meaningful and relevant. What is the minimum required sample size per group, accounting for a 0.05 dropout rate in the treatment group?</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="op">-</span><span class="fl">0.20</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"independent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &gt;= 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &lt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 310 and 310  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="co"># account for attrition</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">310</span>, rate <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># control</span></span>
<span><span class="co">#&gt; 310</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">310</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="co"># treatment</span></span>
<span><span class="co">#&gt; 327</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for comparing treatment and control groups on psychosomatic symptoms. The analysis assumed a small effect size (Cohen’s d = 0.20), 0.80 statistical power, and a 0.05 significance level (one-tailed). Results indicated that 310 participants per group are needed (620 total). To account for an anticipated 0.05 attrition in the treatment group, an additional 17 participants are required, bringing the total sample size to 637.</p>
</div>
<div class="section level3">
<h3 id="robust-parametric">Robust Parametric<a class="anchor" aria-label="anchor" href="#robust-parametric"></a>
</h3>
<p>Unlike experimental designs, group variances and population proportions may differ for some pre-existing groups (e.g. male and female teachers). Assume the smallest effect size of interest is Cohen’s d = 0.20. The expected variance ratio (female to male) is 1.5, and the prevalence ratio (female to male) in the population is 2. What is the minimum required sample size per group under these conditions?</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/means.student.welch.html">power.t.welch</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>              power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>              n.ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              var.ratio <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>              alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Welch's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 517 and 259  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for comparing females and males. The analysis assumed a small effect (Cohen’s d = 0.20), 0.80 power, and 0.05 significance level (two-tailed). The analysis additionally incorporated realistic population characteristics: unequal variances (variance ratio = 1.5, females relative to males) and unequal group prevalence (2:1 female-to-male ratio). Results indicated that 517 females and 259 males are required (776 total).</p>
</div>
<div class="section level3">
<h3 id="non-parametric">Non-Parametric<a class="anchor" aria-label="anchor" href="#non-parametric"></a>
</h3>
<p>The outcome variable may be treated as continuous, but does not follow a normal distribution - for example, Likert-type scales with 5 to 7 categories, ranked data, or other bounded ordinal measures. Assume the smallest effect size of interest between the treatment and control groups is Cohen’s d = 0.20. What is the minimum required sample size per group, accounting for a 0.05 dropout rate in the treatment group?</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  n.ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"independent"</span>,</span>
<span>                  distribution <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Rank-Sum Test (Independent Samples) </span></span>
<span><span class="co">#&gt; (Wilcoxon-Mann-Whitney or Mann-Whitney U Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 412 and 412  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">412</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="co"># treatment</span></span>
<span><span class="co">#&gt; 434</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for comparing treatment and control groups on a Likert-type outcome measure, assuming that the observed categories reflect an underlying continuous latent construct that follows a normal distribution. The analysis assumed a small effect size (Cohen’s d = 0.20), 0.80 statistical power, and a 0.05 significance level (two-tailed). Results indicated that 412 participants per group are needed (824 total). To account for an anticipated 0.05 attrition in the treatment group, an additional 22 participants are required, bringing the total sample size to 846.</p>
</div>
<div class="section level3">
<h3 id="non-inferiority">Non-Inferiority<a class="anchor" aria-label="anchor" href="#non-inferiority"></a>
</h3>
<p>A non-inferiority trial, which may evaluate the effectiveness of a new program, drug, or product, tests whether the mean outcome in the treatment group is not unacceptably worse than that in the conventional-treatment or placebo group, based on a pre-specified non-inferiority margin. For instance, a <code>d - null.d</code> difference as small as <code>margin = -0.05</code> may still support a conclusion of non-inferiority. What is the minimum required sample size to detect an effect size of d = 0.20 under this criterion?</p>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p>When higher values of an outcome is better the margin usually takes NEGATIVE values; whereas when lower values of the outcome is better margin usually takes POSITIVE values.</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parametric (an example report is provided below)</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                margin <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"independent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 199 and 199  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span>
<span></span>
<span><span class="co"># consider 0.05 attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">398</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 419</span></span>
<span></span>
<span><span class="co"># robust parametric</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.welch</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>              margin <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>,</span>
<span>              n.ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              var.ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>              alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Welch's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 238 and 119  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                  margin <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"independent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Rank-Sum Test (Independent Samples) </span></span>
<span><span class="co">#&gt; (Wilcoxon-Mann-Whitney or Mann-Whitney U Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 208 and 208  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for a non-inferiority trial comparing treatment and placebo groups. The analysis assumed a small treatment effect (d = 0.20), a non-inferiority margin of d = -0.05, 0.80 power, and a 0.05 significance level using a one-tailed test appropriate for non-inferiority designs. Results indicated that 199 participants per group (398 total) are needed to demonstrate that the treatment is not meaningfully inferior to the placebo. Accounting for an anticipated 0.05 attrition rate, we will recruit an additional 21 participants, yielding a target sample size of 419 participants.</p>
</div>
<div class="section level3">
<h3 id="superiority">Superiority<a class="anchor" aria-label="anchor" href="#superiority"></a>
</h3>
<p>A superiority trial evaluates whether a new program, drug, or product leads to a meaningfully better mean outcome in the treatment group compared to a conventional treatment or placebo group, based on a pre-specified superiority margin. For example, a <code>d - null.d</code> difference as small as <code>margin = 0.05</code> may be considered sufficient to claim superiority. What is the minimum required sample size to detect an effect size of d = 0.20 under this criterion?</p>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p>When higher values of an outcome is better margin usually takes POSITIVE values; whereas when lower values of the outcome is better margin usually takes NEGATIVE values.</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parametric (an example report is provided below)</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                margin <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"independent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 552 and 552  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span>
<span></span>
<span><span class="co"># consider 0.05 attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1104</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1163</span></span>
<span></span>
<span><span class="co"># robust parametric</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.welch</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>              margin <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>              n.ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              var.ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>              alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Welch's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 662 and 331  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                  margin <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"independent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Rank-Sum Test (Independent Samples) </span></span>
<span><span class="co">#&gt; (Wilcoxon-Mann-Whitney or Mann-Whitney U Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 578 and 578  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for a superiority trial comparing treatment and placebo groups. The analysis assumed a small treatment effect (d = 0.20), a superiority margin of d = 0.05, 0.80 power, and a 0.05 significance level using a one-tailed test appropriate for superiority designs. Results indicated that 552 participants per group (1104 total) are needed to demonstrate that the treatment is meaningfully superior to the placebo. Accounting for an anticipated 0.05 attrition rate in both groups, we will recruit an additional 59 participants, yielding a target sample size of 1163 participants.</p>
</div>
<div class="section level3">
<h3 id="equivalence">Equivalence<a class="anchor" aria-label="anchor" href="#equivalence"></a>
</h3>
<p>An equivalence trial evaluates whether a new program, drug, or product performs similarly to a conventional treatment or placebo, within a pre-specified equivalence margin. For example, a difference of <code>d - null.d</code> falling within the range <code>margin = c(-0.10, 0.10)</code> may be considered sufficient to claim equivalence. What is the minimum required sample size to detect an effect size of d = 0.20 under this criterion?</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parametric (an example report is provided below)</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.10</span>, <span class="fl">0.10</span><span class="op">)</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"independent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 1714 and 1714  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="co"># consider 0.05 attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3428</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3609</span></span>
<span></span>
<span><span class="co"># robust parametric</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.welch</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>              margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.10</span>, <span class="fl">0.10</span><span class="op">)</span>,</span>
<span>              n.ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              var.ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>              alternative <span class="op">=</span> <span class="st">"two.one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Welch's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 2056 and 1028  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                  margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.10</span>, <span class="fl">0.10</span><span class="op">)</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"independent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Rank-Sum Test (Independent Samples) </span></span>
<span><span class="co">#&gt; (Wilcoxon-Mann-Whitney or Mann-Whitney U Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 1795 and 1795  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for an equivalence trial comparing a new treatment to a conventional one. The analysis assumed no difference (d = 0), an equivalence margin ranging from d = -0.10 to d = 0.10, 0.80 power, and a 0.05 significance level using a two one-sided test appropriate for equivalence designs. Results indicated that 1714 participants per group (3428 total) are needed to demonstrate that the new treatment is similar to the conventional one. Accounting for an anticipated 0.05 attrition rate in both groups, we will recruit an additional 181 participants, yielding a target sample size of 3609 participants.</p>
</div>
<div class="section level3">
<h3 id="minimum-effect">Minimum Effect<a class="anchor" aria-label="anchor" href="#minimum-effect"></a>
</h3>
<p>Minimum effect testing is useful when the goal is to assess whether a new program, drug, or product performs meaningfully better or worse than a conventional treatment-beyond a pre-defined threshold of practical significance (equivalence margins). For instance, a difference of <code>d - null.d</code> falling outside the range <code>margin = c(-0.05, 0.05)</code> may be sufficient to conclude that the intervention is either inferior or superior, exceeding the bounds of minimal practical importance. What is the minimum required sample size to detect an effect size of Cohen’s d = 0.20 under this criterion?</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parametric (an example report is provided below)</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"independent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim  : d - null.d &gt;= min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &lt; min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 700 and 700  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="co"># consider 0.05 attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1400</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1474</span></span>
<span></span>
<span><span class="co"># robust parametric</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.welch</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>              margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>              n.ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              var.ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>              alternative <span class="op">=</span> <span class="st">"two.one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Welch's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim  : d - null.d &gt;= min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &lt; min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 841 and 421  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                  margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"independent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Rank-Sum Test (Independent Samples) </span></span>
<span><span class="co">#&gt; (Wilcoxon-Mann-Whitney or Mann-Whitney U Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim  : d - null.d &gt;= min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &lt; min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 733 and 733  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for minimum effect testing comparing a new treatment to a conventional one. The analysis assumed a modest difference (d = 0.20), an equivalence margin ranging from d = -0.05 to d = 0.05, 0.80 power, and a 0.05 significance level using a two one-sided test appropriate for minimum effect testing. Results indicated that 700 participants per group (1400 total) are needed to reliably detect whether the new treatment differs from the conventional treatment by more than the minimally important difference. Accounting for an anticipated 0.05 attrition rate in both groups, we will recruit an additional 74 participants, yielding a target sample size of 1474 participants.</p>
</div>
</div>
<div class="section level2">
<h2 id="paired-samples-t-test">Paired Samples T-Test<a class="anchor" aria-label="anchor" href="#paired-samples-t-test"></a>
</h2>
<p>A paired samples t-test is used to compare the mean outcomes of two related or matched groups, where each observation in one group is paired with a corresponding observation in the other. This test is appropriate when the outcome values are not independent, such as when measurements are taken from the same individuals at two time points (e.g., pre-test and post-test), or when individuals are matched based on characteristics (e.g., siblings, matched pairs in experimental designs).</p>
<div class="section level3">
<h3 id="parametric-1">Parametric<a class="anchor" aria-label="anchor" href="#parametric-1"></a>
</h3>
<p><strong>Example</strong>: A mental health clinic transitions from in-person to online-only group therapy sessions due to logistical constraints. To evaluate whether the new format supports a core therapeutic outcome - emotional regulation - researchers plan to recruit a new group of clients participating in online therapy and compare their outcomes to a historical sample of clients who previously completed the same program in person. Participants will be matched based on baseline symptom severity, age, gender, and diagnosis. The primary outcome is emotional regulation, assessed at the end of the program using the Difficulties in Emotion Regulation Scale (DERS). A two-sided test will be conducted to determine whether emotional regulation improves or deteriorates in the online format in comparison to the in-person format. Researchers aim to detect a small effect (d = 0.20), using a two-sided test with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05 and 0.80 power. What is the minimum required sample size under this criterion?</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"paired"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Paired Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 199  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.198</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.802</span></span>
<span></span>
<span><span class="co"># consider an attrition rate of 0.05</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">199</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 210</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for comparing emotional regulation scores in online versus in-person therapy sessions. The analysis assumed a modest difference between groups (d = 0.20), 0.80 power, and a 0.05 significance level using a two-sided test. Results indicated that 199 participants will need to be matched to reliably determine whether online therapy is better or worse than in-person therapy. Accounting for an anticipated 0.05 attrition in the online group, an additional 11 participants need to be matched, yielding a target sample size of 210 participants.</p>
</div>
<div class="section level3">
<h3 id="non-parametric-1">Non-parametric<a class="anchor" aria-label="anchor" href="#non-parametric-1"></a>
</h3>
<p><strong>Example</strong>: Consider the <a href="#paired-t-parametric">earlier example</a>, but now with a focus on a different outcome: session satisfaction ratings, measured on a 5-point scale (1 = Not at all, 5 = Extremely). Researchers aim to determine whether satisfaction ratings differ between the online and in-person formats. To test this, they plan to use the Wilcoxon signed-rank test for paired data, targeting a small effect size (d = 0.20) with a two-sided significance level of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05. What is the minimum required sample size under these conditions?</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"paired"</span>,</span>
<span>                  distribution <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Signed-Rank Test (Paired Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 208  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span>
<span></span>
<span><span class="co"># consider an attrition rate of 0.05</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">208</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 219</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for comparing session satisfaction ratings in online versus in-person therapy sessions using Wilcoxon signed-rank test. The analysis assumed a modest difference between groups (d = 0.20), 0.80 power, a 0.05 significance level using a two-sided test, and normal distribution. Results indicated that 208 participants will need to be matched to reliably determine whether online therapy is better or worse than in-person therapy in terms of session satisfaction ratings. Accounting for an anticipated 0.05 attrition in the online group, an additional 11 participants need to be matched, yielding a target sample size of 219 participants.</p>
</div>
<div class="section level3">
<h3 id="non-inferiority-1">Non-inferiority<a class="anchor" aria-label="anchor" href="#non-inferiority-1"></a>
</h3>
<p>Consider the <a href="#paired-t-parametric">earlier example</a>, but now with a focus on a different outcome: perceived group cohesion. To evaluate whether the new format preserves the perceived group cohesion, researchers plan to conduct a non-inferiority test to assess whether perceived group cohesion ratings in the online group is not meaningfully worse than that of the matched in-person group. The researcher expects no change (<code>d = 0</code>). The <code>d - null.d</code> difference can be as small as <code>margin = -0.10</code> but the online format will still be considered as non-inferior. What is the minimum required sample size under this criterion?</p>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p>When higher values of an outcome is better the margin usually takes NEGATIVE values; whereas when lower values of the outcome is better margin usually takes POSITIVE values.</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parametric (an example report is provided below)</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                margin <span class="op">=</span> <span class="op">-</span><span class="fl">0.10</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"paired"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Paired Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 619  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="co"># consider 0.05 attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">619</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 652</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                  margin <span class="op">=</span> <span class="op">-</span><span class="fl">0.10</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"paired"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Signed-Rank Test (Paired Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 648  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for a non-inferiority test comparing perceived group cohesion ratings in online versus in-person therapy sessions. The analysis assumed no true difference between groups (d = 0), a non-inferiority margin of -0.10, 0.80 power, and a 0.05 significance level using a one-sided test appropriate for non-inferiority designs. Results indicated that 619 participants will need to be matched to reliably determine whether online therapy is not meaningfully worse than in-person therapy by more than the pre-specified margin. Accounting for an anticipated 0.05 attrition in the online group, an additional 33 participants are required, yielding a target sample size of 652 participants.</p>
</div>
<div class="section level3">
<h3 id="superiority-1">Superiority<a class="anchor" aria-label="anchor" href="#superiority-1"></a>
</h3>
<p>Consider the <a href="#paired-t-parametric">earlier example</a>, but now with a focus on a different outcome: psychological safety. While maintaining core therapeutic outcomes is important, the online format may offer additional advantages. One such outcome is psychological safety, which is defined as the comfort in expressing thoughts, emotions, and personal experiences during group sessions without fear of judgment or rejection. To evaluate whether the online format enhances this dimension, researchers plan to recruit a new group of clients beginning online therapy and match them to a historical sample of previous clients who completed the same program in person. Matching is done based on baseline symptom severity, age, gender, and diagnosis.</p>
<p>A superiority test is conducted to assess whether psychological safety ratings are meaningfully higher in the online group compared to the matched in-person group. The researcher is interested in a modest change (<code>d = 0.20</code>), and <code>d - null.d</code> difference can be as small as <code>margin = 0.10</code> but the online format will still be considered as superior. What is the minimum required sample size under this criterion?</p>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p>When higher values of an outcome is better margin usually takes POSITIVE values; whereas when lower values of the outcome is better margin usually takes NEGATIVE values.</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parametric (an example report is provided below)</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                margin <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"paired"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Paired Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 627  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="co"># consider 0.05 attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">627</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 660</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                  margin <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"paired"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Signed-Rank Test (Paired Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 657  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for a superiority test comparing psychological safety ratings in online versus in-person therapy sessions. The analysis assumed a modest difference between groups (d = 0.20), a superiority margin of 0.10, 0.80 power, and a 0.05 significance level using a one-sided test appropriate for superiority designs. Results indicated that 627 participants will need to be matched to reliably determine whether online therapy is not meaningfully better than in-person therapy by more than the pre-specified margin. Accounting for an anticipated 0.05 attrition in the online group, an additional 33 participants are required, yielding a target sample size of 660 participants.</p>
</div>
<div class="section level3">
<h3 id="equivalence-1">Equivalence<a class="anchor" aria-label="anchor" href="#equivalence-1"></a>
</h3>
<p><strong>Example</strong>: Consider the <a href="#paired-t-parametric">earlier example</a>, but now with a focus on a different outcome: emotional intensity. While the new format is expected to retain key therapeutic benefits, certain outcomes must remain stable for the intervention to be considered acceptable. One such outcome is emotional intensity during sessions, defined as the typical depth and strength of emotions experienced and expressed by participants in group discussions. Too little emotional intensity may signal disengagement or superficial participation, while too much may overwhelm participants or disrupt group cohesion. Therefore, maintaining a similar level of emotional intensity in the online format is essential. To evaluate this, researchers plan to recruit a new group of clients beginning online therapy and match them to a historical sample of previous clients who completed the same program in person. Matching is done based on baseline symptom severity, age, gender, and diagnosis.</p>
<p>An equivalence test will be conducted to assess whether emotional intensity scores in the online group are meaningfully similar to those in the matched in-person group. The researcher is interested in detecting no difference (d = 0). The <code>d - null.d</code> difference within the range <code>margin = c(-0.10, 0.10)</code> is considered sufficient to claim equivalence. What is the minimum required sample size under this criterion?</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parametric (an example report is provided below)</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.10</span>, <span class="fl">0.10</span><span class="op">)</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"paired"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Paired Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 858  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="co"># consider 0.05 attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">858</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 904</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                  margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.10</span>, <span class="fl">0.10</span><span class="op">)</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"paired"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Signed-Rank Test (Paired Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 898  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for an equivalence test comparing emotional intensity during online versus in-person group therapy sessions. The analysis assumed no difference between groups (d = 0), an equivalence margin of -0.10 and 0.10, 0.80 power, and a 0.05 significance level using a two one-sided test appropriate for equivalence designs. Results indicated that 858 participants will need to be matched to reliably determine whether emotional intensity in online therapy is meaningfully similar to that in in-person therapy within the pre-specified equivalence margin. Accounting for an anticipated 0.05 attrition in the online group, an additional 46 participants are required, yielding a target sample size of 904 participants.</p>
</div>
<div class="section level3">
<h3 id="minimum-effect-1">Minimum Effect<a class="anchor" aria-label="anchor" href="#minimum-effect-1"></a>
</h3>
<p>Consider the <a href="#paired-t-parametric">earlier example</a>, with the same outcome: emotional regulation. Different from the earlier example, the null hypothesis is no longer point zero but stated in terms of equivalence interval.</p>
<p>An minimal effect test will be conducted to assess whether emotional regulation scores in the online group are meaningfully different to those in the matched in-person group. The researcher is interested in detecting a modest difference (d = 0.20). The <code>d - null.d</code> difference outside of the range <code>margin = c(-0.10, 0.10)</code> is considered sufficient to claim difference. What is the minimum required sample size under this criterion?</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parametric (an example report is provided below)</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="op">-</span><span class="fl">0.20</span>,</span>
<span>                margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.10</span>, <span class="fl">0.10</span><span class="op">)</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"paired"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Paired Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim  : d - null.d &gt;= min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &lt; min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 797  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span>
<span></span>
<span><span class="co"># consider 0.05 attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">797</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 839</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="op">-</span><span class="fl">0.20</span>,</span>
<span>                  margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"paired"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Signed-Rank Test (Paired Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim  : d - null.d &gt;= min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &lt; min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 370  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for a minimal effect test comparing emotional regulation during online versus in-person group therapy sessions. The analysis assumed a modest difference between groups (d = 0.20), an equivalence margin of -0.10 and 0.10, 0.80 power, and a 0.05 significance level using a two one-sided test appropriate for minimal effect testing. Results indicated that 797 participants will need to be matched to reliably determine whether emotional regulation in online therapy is meaningfully different from in-person therapy. Accounting for an anticipated 0.05 attrition in the online group, an additional 42 participants are required, yielding a target sample size of 839 participants.</p>
</div>
</div>
<div class="section level2">
<h2 id="one-sample-t-test">One-Sample T-Test<a class="anchor" aria-label="anchor" href="#one-sample-t-test"></a>
</h2>
<p>A one-sample t-test is used to determine whether the mean of a single group differs significantly from a known or hypothesized population value. This test is appropriate when comparing an observed sample mean to a fixed reference point-such as a national average, theoretical benchmark, or target score.</p>
<div class="section level3">
<h3 id="parametric-2">Parametric<a class="anchor" aria-label="anchor" href="#parametric-2"></a>
</h3>
<p><strong>Example</strong>: A school district is interested in determining teacher stress levels after introducing a new program that involves extensive teaching activities and evaluation of students. The research division plan to administer the Perceived Stress Scale (PSS) to teachers, which produces total scores ranging from 0 to 40. The primary goal is to determine whether the average stress level among teachers is meaningfully elevated. A mean score of 22 or higher - two points above the commonly used clinical threshold of 20 - is considered indicative of elevated stress that warrants attention. With an estimated standard deviation of 5, this two-point difference corresponds to a medium effect size (Cohen’s d = 0.40). Assume a one-tailed test with a significance level of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05 and a target power of 0.80. What is the minimum required sample size under this criterion?</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (One Sample)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 52  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.192</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.808</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for assessing whether teachers exhibit elevated stress levels due to workload. Assuming a two-point difference from the clinical threshold (Cohen’s d = 0.40), a one-sided test with 0.80 power, and a 0.05 significance level, the analysis indicated that a minimum of 52 teachers should be surveyed to reliably detect elevated stress.</p>
</div>
<div class="section level3">
<h3 id="non-parametric-2">Non-Parametric<a class="anchor" aria-label="anchor" href="#non-parametric-2"></a>
</h3>
<p><strong>Example</strong>: Consider the <a href="#one-sample-t-parametric">earlier example</a>, but now with a focus on a different outcome that is measured using a single Likert-type item: job satisfaction. Job satisfaction is measured using “Overall, I am satisfied with my job.” and responses range from 1 (strongly disagree) to 5 (strongly agree). A mean score below the neutral point of 3 indicates dissatisfaction. The schools district considers a modest difference between average and neutral point (Cohen’s d = -0.20). Assume a one-tailed test with a significance level of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05 and a target power of 0.80. What is the minimum required sample size under this criterion?</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="op">-</span><span class="fl">0.20</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"one.sample"</span>,</span>
<span>                  distribution <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Signed-Rank Test (One Sample)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 208  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for assessing whether teachers are satisfied with their job. Assuming a modest difference from the neutral point (Cohen’s d = -0.20), a one-sided test with 0.05 significance level and 0.80 power, the analysis indicated that a minimum of 208 teachers should be surveyed.</p>
</div>
<div class="section level3">
<h3 id="practically-greater">Practically Greater<a class="anchor" aria-label="anchor" href="#practically-greater"></a>
</h3>
<p><strong>Example</strong>: Consider the <a href="#one-sample-t-parametric">earlier example</a> that focuses on stress as the primary outcome. Now assume researchers are testing whether the observed difference (<code>d - null.d</code>) exceeds a minimum meaningful effect by specifying <code>margin = 0.10</code> - which correspond to half-point increase in average stress level. Differences smaller than this margin are not considered practically significant or a cause for concern. Researchers plan to use a one-sided test with a significance level of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05 and a desired power of 0.80. What is the minimum required sample size under this configuration?</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parametric</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>                margin <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (One Sample)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 72  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>                  margin <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Signed-Rank Test (One Sample)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 76  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.196</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.804</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for assessing whether stress level of teachers are above the clinical threshold. Assuming a medium difference from the clinical threshold (Cohen’s d = 0.40), a one-sided test with 0.05 significance level and with 0.80 power, the analysis indicated that a minimum of 72 teachers should be surveyed.</p>
</div>
<div class="section level3">
<h3 id="equivalence-2">Equivalence<a class="anchor" aria-label="anchor" href="#equivalence-2"></a>
</h3>
<p><strong>Example</strong>: A sleep research team is evaluating the safety of a new melatonin-based supplement designed to support better sleep in adults without causing excessive drowsiness or oversleeping. To ensure the supplement does not disrupt healthy sleep patterns, they plan to assess whether average nightly sleep duration among users falls within the clinically acceptable range of 6.5 to 8.5 hours, which is considered optimal for most adults. Using a one-sample equivalence t-test with equivalence bounds set at <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math> 1 hour around the target value of 7.5 hours, the researchers aim to demonstrate that the supplement does not lead to under- or oversleeping. A two one-sided tests procedure will be conducted with a significance level of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05 and 0.80 power. Assume a standard deviation of 1.2 hours and an expected mean of 7.5 hours. What is the minimum required sample size under this criterion?</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">7.5</span> <span class="op">-</span> <span class="fl">7.5</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.2</span></span>
<span><span class="va">margin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">(</span><span class="fl">6.5</span> <span class="op">-</span> <span class="fl">7.5</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.2</span>, <span class="op">(</span><span class="fl">8.5</span> <span class="op">-</span> <span class="fl">7.5</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># parametric</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>,</span>
<span>                margin <span class="op">=</span> <span class="va">margin</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (One Sample)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 14  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.174</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.826</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>,</span>
<span>                  margin <span class="op">=</span> <span class="va">margin</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Signed-Rank Test (One Sample)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 14  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.196</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.804</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for assessing whether sleep duration falls within a predefined acceptable range. Assuming no difference (d = 0) with an equivalence margin of d = <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math> 0.83, a two one-sided test with 0.05 significance level and 0.80 power, the analysis indicated that a minimum of 14 participants are needed.</p>
</div>
<div class="section level3">
<h3 id="minimal-effect">Minimal Effect<a class="anchor" aria-label="anchor" href="#minimal-effect"></a>
</h3>
<p><strong>Example</strong>: A research team is testing a new medication developed to treat generalized anxiety disorder and is monitoring whether it disrupts normal sleep patterns. While the drug is designed to reduce anxiety, there is concern it may cause excessive drowsiness or oversleeping. The clinically acceptable sleep range for healthy adults is defined as 6.5 to 8.5 hours per night, with 7.5 hours as the midpoint. The goal is to determine whether the mean sleep duration deviates significantly from 7.5 hours. A sleep duration equal or greater than 9 hours is considered problematic. A one-sample t-test will be used to test whether the average sleep duration differs from the range of normative values. A two one-sided test with a significance level of 0.05 and 0.80 power, and assuming a standard deviation of 1.2 hours. What is the minimum required sample size under this criterion?</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">9</span> <span class="op">-</span> <span class="fl">7.5</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.2</span></span>
<span><span class="va">margin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">(</span><span class="fl">6.5</span> <span class="op">-</span> <span class="fl">7.5</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.2</span>, <span class="op">(</span><span class="fl">8.5</span> <span class="op">-</span> <span class="fl">7.5</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># parametric</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>,</span>
<span>                margin <span class="op">=</span> <span class="va">margin</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                design <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (One Sample)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim  : d - null.d &gt;= min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &lt; min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 74  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.198</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.802</span></span>
<span></span>
<span><span class="co"># non-parametric</span></span>
<span><span class="fu"><a href="reference/means.wilcoxon.html">power.np.wilcoxon</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>,</span>
<span>                  margin <span class="op">=</span> <span class="va">margin</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  alternative <span class="op">=</span> <span class="st">"two.one.sided"</span>,</span>
<span>                  design <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wilcoxon Signed-Rank Test (One Sample)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method       : Guenther</span></span>
<span><span class="co">#&gt;   Distribution : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim  : d - null.d &gt;= min(margin) and </span></span>
<span><span class="co">#&gt;                     d - null.d &lt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &lt; min(margin) or </span></span>
<span><span class="co">#&gt;                     d - null.d &gt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 78  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.196</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.804</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for assessing whether sleep duration falls outside of a predefined acceptable range. Assuming a large difference (d = 1.25) with an equivalence margin of d = <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math> 0.83, a two one-sided test with 0.05 significance level and 0.80 power, the analysis indicated that a minimum of 74 participants are needed.</p>
<p><br><br></p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="proportions-z-test">Proportions (Z-Test)<a class="anchor" aria-label="anchor" href="#proportions-z-test"></a>
</h1>
<hr>
<div class="section level2">
<h2 id="one-sample">One-Sample<a class="anchor" aria-label="anchor" href="#one-sample"></a>
</h2>
<p>A one-sample proportion test compares the proportion of successes in a sample to a known population proportion or hypothesized value. “Success” is defined based on the outcome of interest and can represent various binary events: patient recovery, disease presence, survival, website click-through, customer retention, exam passage, program completion, or any other yes / no outcome relevant to the research question.</p>
<div class="section level3">
<h3 id="approximate">Approximate<a class="anchor" aria-label="anchor" href="#approximate"></a>
</h3>
<p>This approach assumes that the test statistics follow a standard normal distribution.</p>
<p><strong>Example</strong>: A regional traffic safety agency plans to conduct an observational study to estimate seat belt use among daytime drivers. While state law mandates seat belt use, the agency adopts a 90% compliance rate as a public safety benchmark, consistent with national targets promoted by the National Highway Traffic Safety Administration (NHTSA). A usage rate of 80% or lower would raise concern and potentially trigger enforcement campaigns. Assuming a one-sided test with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math> and 0.80 power, how many vehicles should be observed?</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.oneprop.html">power.z.oneprop</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.80</span>, <span class="co"># probability of success under alternative</span></span>
<span>                null.prob <span class="op">=</span> <span class="fl">0.90</span>, <span class="co"># probability of success under null</span></span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One Proportion</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method                 : Normal Approximation</span></span>
<span><span class="co">#&gt;   Continuity Correction  : FALSE</span></span>
<span><span class="co">#&gt;   Arcsine Transformation : FALSE</span></span>
<span><span class="co">#&gt;   Standard Error         : Calculated From Null</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)        : prob - null.prob &gt;= 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)        : prob - null.prob &lt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size           = 69  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)  = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)   = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power     = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for assessing whether the rate of seat belt use falls below the predetermined compliance benchmark. A true usage rate of 80% or lower is considered cause for concern relative to the 90% target. Assuming a one-sided test with a significance level of 0.05 and 0.80 power, the analysis indicated that a minimum of 69 vehicles should be observed.</p>
<p><strong>Arcsine transformation</strong>:</p>
<p>The arcsine transformation stabilizes variance of proportion differences. It can be useful for proportions towards the extreme.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.oneprop.html">power.z.oneprop</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.80</span>, <span class="co"># probability of success under alternative</span></span>
<span>                null.prob <span class="op">=</span> <span class="fl">0.90</span>, <span class="co"># probability of success under null</span></span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                arcsine <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One Proportion</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method                 : Normal Approximation</span></span>
<span><span class="co">#&gt;   Continuity Correction  : FALSE</span></span>
<span><span class="co">#&gt;   Arcsine Transformation : TRUE</span></span>
<span><span class="co">#&gt;   Standard Error         : Calculated From Null</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)        : prob - null.prob &gt;= 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)        : prob - null.prob &lt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size           = 54  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)  = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)   = 0.197</span></span>
<span><span class="co">#&gt;   Statistical Power     = 0.803</span></span></code></pre></div>
<p><strong>Continuity correction</strong>:</p>
<p>Continuity correction improves the normal approximation for small samples by accounting for the discrete nature of the outcome, resulting in more accurate test statistics.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.oneprop.html">power.z.oneprop</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.80</span>, <span class="co"># probability of success under alternative</span></span>
<span>                null.prob <span class="op">=</span> <span class="fl">0.90</span>, <span class="co"># probability of success under null</span></span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                correct <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One Proportion</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method                 : Normal Approximation</span></span>
<span><span class="co">#&gt;   Continuity Correction  : TRUE</span></span>
<span><span class="co">#&gt;   Arcsine Transformation : FALSE</span></span>
<span><span class="co">#&gt;   Standard Error         : Calculated From Null</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)        : prob - null.prob &gt;= 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)        : prob - null.prob &lt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size           = 79  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)  = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)   = 0.198</span></span>
<span><span class="co">#&gt;   Statistical Power     = 0.802</span></span></code></pre></div>
<p><strong>Calculate the standard error using the probability of success under the alternative hypothesis</strong>:</p>
<p>The default procedure calculates the standard error using probability of success under the null hypothesis (as in the PASS). This approach adjusts null distribution standard deviation to obtain more precise critical values. This can be changed via <code>std.error</code> argument. For null values close to zero or one, it is more appropriate to use the <a href="#one-prop-exact">exact test</a>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.oneprop.html">power.z.oneprop</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.80</span>, <span class="co"># probability of success under alternative</span></span>
<span>                null.prob <span class="op">=</span> <span class="fl">0.90</span>, <span class="co"># probability of success under null</span></span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                std.error <span class="op">=</span> <span class="st">"alternative"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One Proportion</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method                 : Normal Approximation</span></span>
<span><span class="co">#&gt;   Continuity Correction  : FALSE</span></span>
<span><span class="co">#&gt;   Arcsine Transformation : FALSE</span></span>
<span><span class="co">#&gt;   Standard Error         : Calculated From Alternative</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)        : prob - null.prob &gt;= 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)        : prob - null.prob &lt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size           = 99  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)  = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)   = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power     = 0.8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exact-binomial">Exact (Binomial)<a class="anchor" aria-label="anchor" href="#exact-binomial"></a>
</h3>
<p><strong>Example</strong>: A pharmaceutical company is evaluating the safety profile of a new medication developed for generalized anxiety disorder and is monitoring for the occurrence of skin rash. The company finds a minimum rate of 2 in 1000 as problematic. The research division plan a one-sided test with a significance level of 0.05 and 0.80 power. What is the minimum required sample size under this criterion?</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.oneprop.html">power.exact.oneprop</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.002</span>, <span class="co"># probability of success under alternative</span></span>
<span>                    null.prob <span class="op">=</span> <span class="fl">0</span>, <span class="co"># probability of success under null</span></span>
<span>                    power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One Proportion</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method                 : Exact</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)        : prob - null.prob &lt;= 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)        : prob - null.prob &gt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size           = 804  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)  = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)   = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power     = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for assessing the rash prevalence. Assuming a rate of 2 in 1000, a one-sided test with 0.05 significance level and 0.80 power, the analysis indicated that a minimum of 804 participants are needed.</p>
</div>
</div>
<div class="section level2">
<h2 id="independent-samples">Independent Samples<a class="anchor" aria-label="anchor" href="#independent-samples"></a>
</h2>
<p>An independent samples proportion test compares the proportion of “successes” between two distinct groups (groups are not related, paired, or matched) to determine whether a statistically significant difference exists. Group may exist naturally (females - males, urban - rural, etc.) or formed by the researcher (new - standard drug, intervention - control, etc.).</p>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p>Cohen’s h is a standard effect size metric for power analyses with proportions; it is calculated on arcsine-transformed success probabilities. Although h plays the same role for proportions that Cohen’s d plays for means, the practical gap between a z-test for proportions and an independent-samples t-test for continuous data is usually negligible - sample size estimates rarely vary by more than one or two units. Consequently, applying the familiar t-test framework yields power calculations that are acceptably accurate.</p>
</div>
<p><br></p>
<p>Here is an example that compares the two approaches:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># z-test approach</span></span>
<span><span class="fu"><a href="reference/proportions.twoprops.html">power.z.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.60</span>, prob2 <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>, arcsine <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Normal Approximation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob1 - prob2 = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob1 - prob2 != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 388 and 388  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span>
<span></span>
<span><span class="co"># find Cohen's h</span></span>
<span><span class="fu"><a href="reference/conversion.probs.to.h.html">probs.to.h</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.60</span>, prob2 <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span></span>
<span><span class="co">#&gt;         h     prob1     prob2 </span></span>
<span><span class="co">#&gt; 0.2013579 0.6000000 0.5000000</span></span>
<span></span>
<span><span class="co"># t-test approach</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.2013579</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 389 and 389  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
<div class="section level3">
<h3 id="approximate-1">Approximate<a class="anchor" aria-label="anchor" href="#approximate-1"></a>
</h3>
<p><strong>Example</strong>: A pharmaceutical company is investigating a new medication intended to treat generalized anxiety disorder. While its anti-anxiety efficacy is being evaluated elsewhere, early case reports suggest that daytime sleepiness - recorded as a binary outcome (present vs. absent) - may occur more frequently in women than in men. To verify this potential gender-specific side effect, researchers will enroll equal numbers of male and female patients, administer the drug for four weeks, and document whether each participant experiences clinically significant daytime sleepiness. A five percent difference is considered clinically meaningful which warrants attention. The research division plan a one-sided test with a significance level of 0.05 and 0.80 power. What is the minimum required sample size under this criterion?</p>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p>A key difficulty in planning studies of proportion differences is that a fixed absolute gap translates to different Cohen’s h values depending on where it falls on the 0 - 1 scale. A change from 50% to 55% (near the midpoint) yields a very small h and thus demands extremely large samples, whereas the same 5% increase from 1% to 6% produces a much larger h and requires far fewer participants. For that reason, it is essential to anchor the power analysis to a realistic baseline proportion, ideally drawn from administrative or historical data. For planning purposes, we will assume that roughly 10% of patients taking the current standard medication experience daytime sleepiness. We will use this 10% figure as the reference rate when estimating the sample size needed to detect any gender-specific increase with the new drug. In many cases, researchers lack prior information about the event probabilities. Using 50% as the reference point for one group - against which an increase or decrease is of interest - is a conservative approach in power analysis. The actual probability may not be anywhere near 50% and that is fine.</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.z.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                 prob2 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Normal Approximation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob1 - prob2 &lt;= 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob1 - prob2 &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 540 and 540  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the required sample size for assessing whether gender differences exist in daytime sleepiness. The analysis assume a rate of 15% for females and 10% for males, a one-sided test with 0.05 significance level and 0.80 power. Results indicated that a minimum of 540 participants are needed per group (1080 total).</p>
<p><strong>Arcsine transformation</strong>:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.z.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                 prob2 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                 arcsine <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Normal Approximation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob1 - prob2 &lt;= 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob1 - prob2 &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 536 and 536  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><strong>Continuity correction</strong>:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.z.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                 prob2 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                 correct <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Normal Approximation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob1 - prob2 &lt;= 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob1 - prob2 &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 580 and 580  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><strong>Calculate the standard error using the unpooled standard deviations</strong>:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.z.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                 prob2 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                 std.error <span class="op">=</span> <span class="st">"unpooled"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Normal Approximation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob1 - prob2 &lt;= 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob1 - prob2 &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 538 and 538  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exact-fisher">Exact (Fisher)<a class="anchor" aria-label="anchor" href="#exact-fisher"></a>
</h3>
<p><strong>Example</strong>: A metropolitan library system is piloting two new reminder strategies to boost the timely return of overdue books - a naturally binary outcome, as a patron either brings the item back within the amnesty window (yes) or does not (no). Borrowers with an approaching due date will be randomly assigned to one of two groups. Group A receives an interactive WhatsApp chatbot that walks them through renewal or return options, whereas Group B receives a gamified in-app badge that awards points for prompt returns. The reminder system will be judged worthwhile if return rate for either of the group exceeds the other by at least 10 percentage points. The decision will help which reminder system to invest on considering their cost. Because no prior data exist, planners adopt the “worst-case scenario” approach that maximizes required sample size: a rise from 50% to 60%. Using a one-sided test with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05 and 0.80 power, what is the minimum number of patrons needed in each group?</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.exact.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.60</span>,</span>
<span>                     prob2 <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                     power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                     alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                     alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Fisher's Exact</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob1 - prob2 &lt;= 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob1 - prob2 &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 278 and 278  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.000</span></span>
<span><span class="co">#&gt;   Statistical Power    = 1</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to estimate the required sample size for evaluating the relative effectiveness of two reminder systems. Assuming a 10% difference (from 50% to 60%), a one-sided test with 0.05 significance level and 0.80 power, the analysis indicated that a minimum of 321 patrons are needed in each group (642 total).</p>
</div>
<div class="section level3">
<h3 id="non-inferiority-2">Non-inferiority<a class="anchor" aria-label="anchor" href="#non-inferiority-2"></a>
</h3>
<p><strong>Example</strong>: A pharmaceutical company is conducting a non-inferiority trial to evaluate the safety profile of a new medication developed for generalized anxiety disorder, focusing specifically on the occurrence of skin rash as a side effect. The current standard treatment has a skin rash rate of approximately 2 per 1,000 patients (0.2%). The company wants to ensure that the new medication does not lead to a clinically unacceptable increase in this side effect. They expect the new drug to have a skin rash rate of approximately 1 per 1,000 patients (0.1%) and define a non-inferiority margin of 1 per 1,000 (0.1%), meaning the new drug’s skin rash rate should not exceed 0.3% to be considered non-inferior. Assuming a one-sided test with a 0.05 significance level, 0.80 power, and a 0.05 attrition rate for both groups, what is the minimum required sample size to evaluate non-inferiority under this criterion?</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.z.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                 prob2 <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>                 margin <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Normal Approximation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob1 - prob2 &gt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob1 - prob2 &lt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 457 and 457  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span>
<span></span>
<span><span class="co"># consider 5% attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">914</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 963</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to estimate the minimum required sample size to evaluate non-inferiority of a new drug for treating generalized anxiety disorder compared to standard treatment. The analysis focused on skin rash as an adverse event, with an assumed prevalence rate of 1 in 1,000 (0.1%) for the new drug and 2 in 1,000 (0.2%) for the standard treatment. Using a non-inferiority margin of 1 in 1,000 (0.1%) increase, a one-sided test at the 0.05 significance level, and 0.80 power, the analysis indicated that a minimum of 457 participants are needed in each group (914 total). Considering a 5% attrition rate a total of 963 participants are needed.</p>
</div>
<div class="section level3">
<h3 id="superiority-test">Superiority Test<a class="anchor" aria-label="anchor" href="#superiority-test"></a>
</h3>
<p><strong>Example</strong>: Consider the <a href="#twoprops-non-inferiority">earlier example</a> that focuses on non-inferiority of a new drug for treating generalized anxiety disorder compared to standard treatment. Now assume researchers aim to evaluate whether the new drug is superior to the standard treatment in reducing the proportion of patients who resort to rescue medication. A 5% absolute reduction in rescue medication use is expected in the new drug group. Since no prior estimates are available, we assume a worst-case scenario with a 50% usage rate in the standard treatment group. Using a 1% superiority margin, a one-sided test with a 0.05 significance level, 0.80 power, and a 5% attrition rate for both groups, what is the minimum required sample size to test for superiority under these conditions?</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.z.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>                 prob2 <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                 margin <span class="op">=</span> <span class="op">-</span><span class="fl">0.01</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Normal Approximation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob1 - prob2 &gt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob1 - prob2 &lt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 1926 and 1926  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span>
<span></span>
<span><span class="co"># consider 5% attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3852</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 4055</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to estimate the minimum required sample size to evaluate the superiority of a new drug for treating generalized anxiety disorder compared to the standard treatment. The analysis focused on the proportion of patients requiring rescue medication, assuming a prevalence rate of 50% in the standard treatment group and 45% in the new drug group. Using at least 1% decrease as the superiority margin, a one-sided test with a 0.05 significance level, and 0.80 power, the analysis indicated that a minimum of 1,926 participants per group (3,852 total) would be required. Accounting for a 5% attrition rate, the total sample size increases to 4,055 participants.</p>
</div>
<div class="section level3">
<h3 id="equivalence-3">Equivalence<a class="anchor" aria-label="anchor" href="#equivalence-3"></a>
</h3>
<p><strong>Example</strong>: A national education ministry implements a new automated scoring system to evaluate high school students for a merit-based university scholarship program. The algorithm incorporates multiple factors including GPA, standardized test scores, extracurricular activities, and socio-economic indicators using a complex weighting system. Despite using seemingly objective inputs, there are concerns that the algorithm’s weighting and interaction effects might inadvertently favor one gender over another - for example, if the system overweights certain activities traditionally dominated by one gender, or if interaction effects between variables create unexpected biases.</p>
<p>Because of these concerns about algorithmic bias in the composite scoring methodology, the ministry wants the eligibility rates (eligible vs. not eligible) for the scholarship must remain equivalent across male and female students. Any disparity greater than <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math> 1% in eligibility rates would be flagged as a potential violation of gender equity policy.</p>
<p>An equivalence trial is conducted to determine whether the new automated scoring system produces statistically equivalent scholarship eligibility rates for male and female students. The standard, human-rated system yields eligibility rates of approximately 10% for both groups. To evaluate equivalence, the analysis uses a two one-sided test with a 0.05 significance level and 0.80 power. What is the minimum required number of applications to process per group to test for equivalence under these conditions?</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.z.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                 prob2 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                 margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.02</span>, <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Normal Approximation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob1 - prob2 &lt;= min(margin) or </span></span>
<span><span class="co">#&gt;                     prob1 - prob2 &gt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob1 - prob2 &gt; min(margin) and </span></span>
<span><span class="co">#&gt;                     prob1 - prob2 &lt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 3854 and 3854  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to estimate the minimum required sample size to evaluate whether a new automated scoring system yields scholarship eligibility rates that are statistically equivalent between male and female students. The analysis assumed a baseline eligibility rate of 10% for both groups under the standard rater-based system. Using an equivalence margin of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math> 5%, a two one-sided test with a 0.05 significance level, and 0.80 power, the analysis indicated that a minimum of 3,854 applications should be processed per group (7,708 total).</p>
</div>
<div class="section level3">
<h3 id="minimum-effect-2">Minimum Effect<a class="anchor" aria-label="anchor" href="#minimum-effect-2"></a>
</h3>
<p><strong>Example</strong>: Consider the <a href="#twoprops-equivalence">earlier example</a> that evaluates whether a new automated scoring system yields scholarship eligibility rates that are statistically equivalent between male and female students. The research team establishes that any gender difference in eligibility rates greater than <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math> 3% would constitute a meaningful disparity requiring algorithmic adjustment. They establish equivalence bounds of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math> 1% in eligibility rates - a threshold considered the smallest practically important effect that warrants monitoring and potential intervention.</p>
<p>A minimal effect test is conducted to check whether the system produces a gender difference of at least 1% in either direction. Using a two one-sided test with 0.05 significance level, 0.80 power, what is the minimum required number of complete applications to process?</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.z.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.13</span>,</span>
<span>                 prob2 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                 margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Normal Approximation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob1 - prob2 &gt;= min(margin) and </span></span>
<span><span class="co">#&gt;                     prob1 - prob2 &lt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob1 - prob2 &lt; min(margin) or </span></span>
<span><span class="co">#&gt;                     prob1 - prob2 &gt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 3992 and 3992  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to estimate the minimum required number of complete scholarship applications to evaluate whether a new automated scoring system results in a gender difference of 3% in eligibility rates (13% for females and 10% for males). Using equivalence bounds of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math> 1%, a two one-sided test with a 0.05 significance level, and 0.80 power, the analysis indicated that a minimum of 3,992 applications should be processed per group (7,984 total).</p>
</div>
</div>
<div class="section level2">
<h2 id="paired-samples">Paired Samples<a class="anchor" aria-label="anchor" href="#paired-samples"></a>
</h2>
<div class="section level3">
<h3 id="approximate-2">Approximate<a class="anchor" aria-label="anchor" href="#approximate-2"></a>
</h3>
<p><strong>Example</strong>: Colorectal cancer screening is recommended for adults aged 50-74 as part of routine preventive care. Traditionally, eligible individuals have been invited to primary care clinics to complete a fecal immuno-chemical test (FIT), a non-invasive screening tool for early detection of colorectal cancer. However, historical administrative records show that only 40% of invited individuals complete the test under this in-clinic invitation model.</p>
<p>To improve public health outcomes, a regional health authority is piloting a new outreach program where FIT kits are mailed directly to individuals’ homes, removing the need to schedule or attend a clinic visit. Researchers recruit a new sample of 50- to 74-year-olds to receive the at-home kits and compare their screening completion rate to the 40% baseline rate from administrative data. The new group (receiving mailed FIT kits) will be matched to the historical administrative cohort (who were invited for in-clinic screening) based on key demographic and clinical characteristics available in health records,</p>
<p>The binary outcome is screening completion (yes / no). The aim is to evaluate whether the at-home kit significantly improves uptake, with an expected 10% increase (from 40% to 50%). A two-sided test, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05, and 0.80 power is planned to estimate the minimum required sample size for the newly recruited group.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.z.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                 prob2 <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                 paired <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 rho.paired <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Paired Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Normal Approximation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob10 - prob01 = 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob10 - prob01 != 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Paired Sample Size   = 200  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.196</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.804</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to estimate the minimum required sample size to evaluate whether a new at-home screening strategy improves colorectal cancer screening completion among adults aged 50-74, compared to historical in-clinic invitation data. Administrative records show that approximately 40% of eligible individuals completed screening under the standard model. The intervention aims to improve this rate by at least 10 percentage points, reaching 50% completion. Using a two-sided test with a 0.05 significance level, 0.80 power, the analysis indicates that a minimum of 200 participants will need to be matched.</p>
</div>
<div class="section level3">
<h3 id="exact-mcnemar">Exact (McNemar)<a class="anchor" aria-label="anchor" href="#exact-mcnemar"></a>
</h3>
<p>Consider the <a href="#twoprops-paired-approx">earlier example</a> that evaluates a new outreach program to increase colorectal cancer screening rates via mailing FIT kits directly to individuals’ homes instead of inviting them the clinic. Instead of relying on the normal approximation for hypothesis testing, researchers will use the exact McNemar’s test. All other parameters remain unchanged; however, an additional 13 subjects need to be matched to maintain the desired power.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/proportions.twoprops.html">power.exact.twoprops</a></span><span class="op">(</span>prob1 <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                     prob2 <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>                     power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                     alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                     alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                     paired <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     rho.paired <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Paired Proportions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : McNemar's Exact</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : prob10 - prob01 = 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : prob10 - prob01 != 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Paired Sample Size   = 213  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.030</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.195</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.805</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="correlations-z-test">Correlations (Z-Test)<a class="anchor" aria-label="anchor" href="#correlations-z-test"></a>
</h1>
<hr>
<div class="section level2">
<h2 id="one-sample-1">One-Sample<a class="anchor" aria-label="anchor" href="#one-sample-1"></a>
</h2>
<p><strong>Example</strong>: A university counseling center is interested in understanding the relationship between students’ self-reported sleep quality and their levels of academic stress. Prior research suggests only weak associations, but the center believes that the relationship may be stronger in their population due to increased course loads and reduced access to support services.</p>
<p>They plan to test whether the Pearson correlation between sleep quality scores and academic stress scores is significantly greater than 0.10, which they define as the minimum meaningful effect size. Researchers define the difference between the expected correlation (0.20) and the benchmark value (0.10) as the minimum meaningful effect size that warrants attention. They plan a one-sided test with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05 and 0.80 power. What is the minimum required sample size under these criteria?</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/correlations.one.html">power.z.onecor</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>               null.rho <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>               power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>               alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-Sample Correlation </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : rho -  null.rho &lt;= 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : rho -  null.rho &gt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 593  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to estimate the minimum required sample size for evaluating whether the correlation between academic stress and sleep disturbance among university students is meaningfully greater than a benchmark value. Researchers identified a correlation of 0.20 as theoretically relevant and set a minimum meaningful difference of 0.10, using 0.10 as the benchmark. A one-sided test with a significance level of 0.05 and 0.80 power was planned. The analysis indicated that a minimum of 593 students would be sufficient.</p>
</div>
<div class="section level2">
<h2 id="independent-samples-1">Independent Samples<a class="anchor" aria-label="anchor" href="#independent-samples-1"></a>
</h2>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p>Cohen’s q is a standard effect size metric for power analyses with correlations; it is calculated on Fisher’s z-transformed correlations. Although q plays the same role for correlations that Cohen’s d plays for means, the practical gap between a z-test for correlations and an independent-samples t-test is usually negligible - sample size estimates rarely vary by more than one or two units. Consequently, applying the familiar t-test framework yields sample size calculations that are acceptably accurate.</p>
</div>
<p><br></p>
<p>Here is an example that compares the two approaches:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># z-test approach</span></span>
<span><span class="fu"><a href="reference/correlations.two.html">power.z.twocors</a></span><span class="op">(</span>rho1 <span class="op">=</span> <span class="fl">0.20</span>, rho2 <span class="op">=</span> <span class="fl">0.10</span>, power <span class="op">=</span> <span class="fl">.80</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Correlations </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : rho1 - rho2 = 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : rho1 - rho2 != 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 1501 and 1501  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span>
<span></span>
<span><span class="co"># find Cohen's q</span></span>
<span><span class="fu"><a href="reference/conversion.cors.to.q.html">cors.to.q</a></span><span class="op">(</span>rho1 <span class="op">=</span> <span class="fl">0.20</span>, rho2 <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></span>
<span><span class="co">#&gt;         q     delta      rho1      rho2 </span></span>
<span><span class="co">#&gt; 0.1023972 0.1000000 0.2000000 0.1000000</span></span>
<span></span>
<span><span class="co"># t-test approach</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.1023972</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 1499 and 1499  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p>A key difficulty in planning studies of correlation differences is that a fixed absolute gap translates to different Cohen’s q values depending on where it falls on the -1 to 1 scale. A change from 10% to 20% yields a small q and thus demands a larger samples, whereas the same 10% increase from 50% to 60% produces a larger q which requires fewer participants. For that reason, it is essential to anchor the power analysis to a realistic baseline correlation, ideally drawn from administrative or historical data. In many cases, researchers lack prior information about the population correlations. Using 0 correlation as the reference point for one group - against which an increase or decrease is of interest - is a conservative approach in power analysis. The actual correlation may not be anywhere near 0 and that is fine.</p>
</div>
<p><br></p>
<p><strong>Example</strong>: A research team is examining whether the association between parental support and academic achievement is stronger in low socio-economic status (SES) schools compared to high-SES schools. If confirmed, they intend to recommend targeted interventions to enhance parental involvement specifically in low-SES settings. To determine the required sample size, the researchers anticipate a small but meaningful difference between the two correlations. They consider a minimum meaningful difference of 0.10 - representing the difference between a correlation of 0 and 0.10 in the worst-case scenario - which corresponds to a small effect size (Cohen’s q = 0.10). Researchers plan to use a one-sided test with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05 and 0.80 power. What is the minimum required sample size under these criteria?</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/correlations.two.html">power.z.twocors</a></span><span class="op">(</span>rho1 <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                rho2 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Independent Correlations </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : rho1 - rho2 &lt;= 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : rho1 - rho2 &gt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 1232 and 1232  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span>
<span></span>
<span><span class="co"># calculate Cohen's h</span></span>
<span><span class="fu"><a href="reference/conversion.cors.to.q.html">cors.to.q</a></span><span class="op">(</span>rho1 <span class="op">=</span> <span class="fl">0.10</span>, rho2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt;         q     delta      rho1      rho2 </span></span>
<span><span class="co">#&gt; 0.1003353 0.1000000 0.1000000 0.0000000</span></span>
<span></span>
<span><span class="co"># t-test approximation</span></span>
<span><span class="fu"><a href="reference/means.student.welch.html">power.t.student</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.1003353</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Student's T-Test (Independent Samples)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : d - null.d &lt;= 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : d - null.d &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 1229 and 1229  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to estimate the minimum required sample size for evaluating whether the correlation between parental support and academic achievement is meaningfully stronger in low socio-economic status (SES) schools compared to high-SES schools. To reflect the most conservative scenario, we considered a minimum meaningful increase from a correlation of 0 to 0.10, representing a small effect size (Cohen’s q = 0.10). The analysis assumed a one-sided test with a significance level of 0.05 and a statistical power of 0.80. Results indicated that data should be collected from at least 1,232 students (and their parents) in each SES group, totaling 2,464 participants.</p>
</div>
<div class="section level2">
<h2 id="paired-samples-1">Paired Samples<a class="anchor" aria-label="anchor" href="#paired-samples-1"></a>
</h2>
<div class="section level3">
<h3 id="one-common-index">One Common Index<a class="anchor" aria-label="anchor" href="#one-common-index"></a>
</h3>
<p><strong>Example</strong>: A research team investigates whether a school-based parental engagement program can reduce the impact of socio-economic status (SES) on academic achievement. Using pre-test and post-test scores, they compare the correlation between SES and achievement before and after the intervention. A power analysis is conducted to detect a small but meaningful change (Cohen’s q = 0.10) in the strength of these correlations. If the post-intervention correlation is weaker, it suggests the program effectively mitigates SES-related disparities.</p>
<p>Several meta-analyses have found a moderate positive correlation between SES and academic achievement (<code>rho12 = 0.30</code>). A reduction from 0.30 to 0.20 is meaningful and warrants attention (<code>rho13 = 0.30</code>). Also based on prior meta-analytic findings, it is common to observe a correlation of 0.70 between pre-test and post-test achievement scores (<code>rho23 = 0.30</code>). Researchers plan to use a one-sided test with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05 and 0.80 power. What is the minimum required sample size under these criteria?</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example data for one common index</span></span>
<span><span class="co"># compare cor(V1, V2) to cor(V1, V3)</span></span>
<span></span>
<span><span class="co"># subject    V1       V2      V3</span></span>
<span><span class="co"># &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#   1       1.2      2.3      0.8</span></span>
<span><span class="co">#   2      -0.0      1.1      0.7</span></span>
<span><span class="co">#   3       1.9     -0.4     -2.3</span></span>
<span><span class="co">#   4       0.7      1.3      0.4</span></span>
<span><span class="co">#   5       2.1     -0.1      0.8</span></span>
<span><span class="co">#   ...     ...      ...      ...</span></span>
<span><span class="co">#   1000   -0.5      2.7     -1.7</span></span>
<span></span>
<span><span class="co"># V1: socio-economic status (common)</span></span>
<span><span class="co"># V2: pre-test</span></span>
<span><span class="co"># V3: post-test</span></span>
<span></span>
<span><span class="fu"><a href="reference/correlations.steiger.html">power.z.twocors.steiger</a></span><span class="op">(</span>rho12 <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                        rho13 <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>                        rho23 <span class="op">=</span> <span class="fl">0.70</span>,</span>
<span>                        power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                        alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                        alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                        common.index <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dependent Correlations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Common Index    : TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : rho12 - rho13 &lt;= 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : rho12 - rho13 &gt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 286  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span>
<span></span>
<span><span class="co"># calculate the effect size</span></span>
<span><span class="fu"><a href="reference/conversion.cors.to.q.html">cors.to.q</a></span><span class="op">(</span>rho1 <span class="op">=</span> <span class="fl">0.40</span>, rho2 <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span></span>
<span><span class="co">#&gt;          q      delta       rho1       rho2 </span></span>
<span><span class="co">#&gt; -0.1256572 -0.1000000  0.4000000  0.5000000</span></span>
<span></span>
<span><span class="co"># adjust the sample for 5% attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">286</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 302</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the minimum sample size required to detect a meaningful reduction in the correlation between SES and academic achievement following a parental engagement intervention. Based on prior meta-analyses, the correlation between SES and academic achievement is assumed to be <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>12</mn></msub><annotation encoding="application/x-tex">\rho_{12}</annotation></semantics></math> = 0.30 at pre-test, with a post-test correlation of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>13</mn></msub><annotation encoding="application/x-tex">\rho_{13}</annotation></semantics></math> = 0.20 representing a meaningful reduction (Cohen’s q = 0.126). The correlation between pre-test and post-test scores is assumed to be <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>23</mn></msub><annotation encoding="application/x-tex">\rho_{23}</annotation></semantics></math> = -0.70. The analysis uses a one-sided Steiger’s Z test to compare dependent correlations, with a significance level of 0.05 and a statistical power of 0.80. Under these assumptions, the minimum required sample size is 286 students. To account for an anticipated 5% attrition rate, an additional 16 students should be included, bringing the total target sample size to 302 students.</p>
</div>
<div class="section level3">
<h3 id="no-common-index">No Common Index<a class="anchor" aria-label="anchor" href="#no-common-index"></a>
</h3>
<p><strong>Example</strong>: A research team investigates whether teaching students meta-cognitive strategies for reading is transferable to the math domain. They expect an increase in the correlation between reading and math scores from pre-test to post-test following an intervention involving activities related to meta-cognition. Based on meta-analytic findings, the typical correlation between reading and math is around 0.50. The team considers an increase from <code>rho12 = 0.50</code> to <code>rho34 = 0.60</code> as meaningful and relevant, corresponding to Cohen’s q = 0.144.</p>
<p>An increase in both average reading and math scores, along with a stronger post-test correlation between reading and math, would suggest that meta-cognitive strategies targeted for reading are transferable to the math domain. Researchers also assume that the correlation between pre-test and post-test reading is <code>rho13 = 0.70</code>, the correlation between pre-test and post-test math is <code>rho24 = 0.70</code>, the correlation between pre-test reading and post-test math is <code>rho14 = 0.40</code>, and the correlation between pre-test math and post-test reading is <code>rho23 = 0.40</code>. Researchers plan to use a one-sided test with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> = 0.05 and 0.80 power. What is the minimum required sample size under these criteria?</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example data for no common index</span></span>
<span><span class="co"># compare cor(V1, V2) to cor(V3, V4)</span></span>
<span></span>
<span><span class="co"># subject    V1       V2       V3       V4</span></span>
<span><span class="co"># &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#   1       1.2      2.3      0.8      1.2</span></span>
<span><span class="co">#   2      -0.0      1.1      0.7      0.9</span></span>
<span><span class="co">#   3       1.9     -0.4     -2.3     -0.1</span></span>
<span><span class="co">#   4       0.7      1.3      0.4     -0.3</span></span>
<span><span class="co">#   5       2.1     -0.1      0.8      2.7</span></span>
<span><span class="co">#   ...     ...      ...      ...      ...</span></span>
<span><span class="co">#   1000   -0.5      2.7     -1.7      0.8</span></span>
<span></span>
<span><span class="co"># V1: pre-test reading</span></span>
<span><span class="co"># V2: pre-test math</span></span>
<span><span class="co"># V3: post-test reading</span></span>
<span><span class="co"># V4: post-test math</span></span>
<span></span>
<span><span class="fu"><a href="reference/correlations.steiger.html">power.z.twocors.steiger</a></span><span class="op">(</span>rho12 <span class="op">=</span> <span class="fl">0.50</span>, <span class="co"># cor(V1, V2)</span></span>
<span>                        rho13 <span class="op">=</span> <span class="fl">0.70</span>,</span>
<span>                        rho23 <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>                        rho14 <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>                        rho24 <span class="op">=</span> <span class="fl">0.70</span>,</span>
<span>                        rho34 <span class="op">=</span> <span class="fl">0.60</span>, <span class="co"># cor(V3, V4)</span></span>
<span>                        power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                        alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                        alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span>
<span>                        common.index <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dependent Correlations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Common Index    : FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : rho12 - rho34 &gt;= 0</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : rho12 - rho34 &lt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 317  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span>
<span></span>
<span><span class="co"># calculate the effect size</span></span>
<span><span class="fu"><a href="reference/conversion.cors.to.q.html">cors.to.q</a></span><span class="op">(</span>rho1 <span class="op">=</span> <span class="fl">0.60</span>, rho2 <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span></span>
<span><span class="co">#&gt;        q    delta     rho1     rho2 </span></span>
<span><span class="co">#&gt; 0.143841 0.100000 0.600000 0.500000</span></span>
<span></span>
<span><span class="co"># adjust the sample for 5% attrition rate</span></span>
<span><span class="fu"><a href="reference/utils.attrition.html">inflate.sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">317</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; 334</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the minimum sample size required to detect a meaningful increase in the correlation between reading and math performance following an intervention involving meta-cognitive strategy instruction in reading. Based on prior meta-analyses, the correlation between reading and math scores is assumed to be <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mn>12</mn></msub><mo>=</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">\rho_{12} = 0.50</annotation></semantics></math> at pre-test, with a post-test correlation of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mn>34</mn></msub><mo>=</mo><mn>0.60</mn></mrow><annotation encoding="application/x-tex">\rho_{34} = 0.60</annotation></semantics></math> representing a meaningful increase (Cohen’s <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>0.144</mn></mrow><annotation encoding="application/x-tex">q = 0.144</annotation></semantics></math>). The analysis also incorporates the following assumed correlations: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mn>13</mn></msub><mo>=</mo><mn>0.70</mn></mrow><annotation encoding="application/x-tex">\rho_{13} = 0.70</annotation></semantics></math> (pre-test reading - post-test reading), <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mn>24</mn></msub><mo>=</mo><mn>0.70</mn></mrow><annotation encoding="application/x-tex">\rho_{24} = 0.70</annotation></semantics></math> (pre-test math - post-test math), <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mn>14</mn></msub><mo>=</mo><mn>0.40</mn></mrow><annotation encoding="application/x-tex">\rho_{14} = 0.40</annotation></semantics></math> (pre-test reading - post-test math), and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mn>23</mn></msub><mo>=</mo><mn>0.40</mn></mrow><annotation encoding="application/x-tex">\rho_{23} = 0.40</annotation></semantics></math> (pre-test math - post-test reading). The analysis uses a one-sided Steiger’s Z test to compare dependent correlations, with a significance level of 0.05 and statistical power of 0.80. Under these assumptions, the minimum required sample size is 317 students. To account for an anticipated 5% attrition rate, an additional 17 students should be included, bringing the total target sample size to 334 students.</p>
<p><br><br></p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="regression-linear-f--and-t-test">Regression: Linear (F- and T-Test)<a class="anchor" aria-label="anchor" href="#regression-linear-f--and-t-test"></a>
</h1>
<hr>
<div class="section level2">
<h2 id="omnibus-f-test">Omnibus F-Test<a class="anchor" aria-label="anchor" href="#omnibus-f-test"></a>
</h2>
<div class="section level3">
<h3 id="r2--0">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">R^2 &gt; 0</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#r2--0"></a>
</h3>
<p>The omnibus F-test in multiple linear regression is used to evaluate whether the model as a whole explains a statistically significant portion of variance in the outcome variable. The null hypothesis states that all regression coefficients (except the intercept) are equal to zero which means none of the predictors contributes meaningfully to explaining the outcome variable (or <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math> is equal to zero). Alternative hypothesis states that at least some regression coefficients (except the intercept) is different from zero (or <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math> is greater than zero).</p>
<p><strong>Example</strong>: Assume that we want to predict a continuous variable <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> using <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math> variables (can be a combination of binary or continuous).</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><mi>r</mi><mo>,</mo><mspace width="1.0em"></mspace><mi>r</mi><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y = \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}X_{3} + r, \quad r \sim N(0, \sigma ^ 2)</annotation></semantics></math></p>
<p>We are interested in a minimum <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math> = 0.10. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.linear.f.html">power.f.regression</a></span><span class="op">(</span>r.squared <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">3</span>, <span class="co"># number of total predictors</span></span>
<span>                   power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Regression (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : R-squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : R-squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 103  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.196</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.804</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the minimum required sample size to detect a small but meaningful effect in a multiple linear regression model predicting a continuous outcome variable <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> from three predictors (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_{3}</annotation></semantics></math>). We are interested in an effect as small as <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.10</mn></mrow><annotation encoding="application/x-tex">R^2 = 0.10</annotation></semantics></math> using an omnibus F-test with a significance level of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math> and statistical power of 0.80. Under these assumptions, the minimum required sample size is 103 participants.</p>
</div>
<div class="section level3">
<h3 id="r2--margin">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math> &gt; Margin<a class="anchor" aria-label="anchor" href="#r2--margin"></a>
</h3>
<p><strong>Example</strong>: Consider the <a href="#reg-f-test">earlier example</a>. Now, instead of testing against a zero null hypothesis (i.e., <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math> = 0), we aim to set a practical null hypothesis for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math> at 0.05 (<code>margin = 0.05</code>), representing the largest effect size considered practically null. What is the minimum required sample size under these conditions?</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.linear.f.html">power.f.regression</a></span><span class="op">(</span>r.squared <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                   margin <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Regression (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : 0 &lt;= R-squared &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : R-squared &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 612  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the minimum required sample size to detect a small but meaningful effect in a multiple linear regression model predicting a continuous outcome variable <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> from three predictors (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_{3}</annotation></semantics></math>). We are interested in an effect as small as <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math> = 0.10 using an omnibus F-test with a significance level of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math> and statistical power of 0.80. An <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math> &lt; 0.05 is considered to have negligible practical significance. Under these assumptions, the minimum required sample size is 612 participants.</p>
</div>
<div class="section level3">
<h3 id="delta-r2--0">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\Delta R^2</annotation></semantics></math> &gt; 0<a class="anchor" aria-label="anchor" href="#delta-r2--0"></a>
</h3>
<p><strong>Example</strong>: Assume that we want to test the incremental contribution of two additional predictors (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>4</mn></msub><annotation encoding="application/x-tex">X_{4}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>5</mn></msub><annotation encoding="application/x-tex">X_{5}</annotation></semantics></math>) to an existing regression model. That is, we are testing whether adding these two predictors (k.tested = 2) results in a significant increase in explained variance. The full model includes five predictors in total (k.total = 5). We are interested in detecting a meaningful increase in explained variance of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.10</mn></mrow><annotation encoding="application/x-tex">\Delta R^2 = 0.10</annotation></semantics></math>. What is the minimum required sample size under these criteria?</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><msub><mi>β</mi><mn>4</mn></msub><msub><mi>X</mi><mn>4</mn></msub><mo>+</mo><msub><mi>β</mi><mn>5</mn></msub><msub><mi>X</mi><mn>5</mn></msub><mo>+</mo><mi>r</mi><mo>,</mo><mspace width="1.0em"></mspace><mi>r</mi><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
Y = \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}X_{3} + \beta_{4}X_{4} + \beta_{5}X_{5} + r, \quad r \sim N(0, \sigma ^ 2)
</annotation></semantics></math></p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.linear.f.html">power.f.regression</a></span><span class="op">(</span>r.squared.change <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">5</span>, <span class="co"># number of total predictors</span></span>
<span>                   k.tested <span class="op">=</span> <span class="fl">2</span>, <span class="co"># number of tested predictors</span></span>
<span>                   power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Hierarchical Linear Regression (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Change in R-squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Change in R-squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 90  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the minimum required sample size to detect a small but meaningful effect in a multiple linear regression model predicting a continuous outcome variable <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> from five predictors (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math> through <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>5</mn></msub><annotation encoding="application/x-tex">X_{5}</annotation></semantics></math>). Our primary interest is in testing the incremental contribution of two predictors (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>4</mn></msub><annotation encoding="application/x-tex">X_{4}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>5</mn></msub><annotation encoding="application/x-tex">X_{5}</annotation></semantics></math>), beyond the initial model that includes <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_{3}</annotation></semantics></math>. Specifically, we aim to detect an increase in explained variance of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.10</mn></mrow><annotation encoding="application/x-tex">\Delta R^2 = 0.10</annotation></semantics></math> using an F-test with a significance level of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math> and statistical power of 0.80. The total number of predictors in the final model is five (<code>k.total = 5</code>), and the number of predictors being tested is two (<code>k.tested = 2</code>). Under these assumptions, the minimum required sample size is 90 participants.</p>
</div>
<div class="section level3">
<h3 id="delta-r2--margin">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\Delta R^2</annotation></semantics></math> &gt; Margin<a class="anchor" aria-label="anchor" href="#delta-r2--margin"></a>
</h3>
<p><strong>Example</strong>: Consider the <a href="#reg-f-test-rsq-change">earlier example</a>. Now, instead of testing against a zero null hypothesis (i.e., <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\Delta R^2</annotation></semantics></math> = 0), we aim to set a practical null hypothesis for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\Delta R^2</annotation></semantics></math> at 0.05 (<code>margin = 0.05</code>), representing the largest effect size considered practically null. What is the minimum required sample size under these conditions?</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.linear.f.html">power.f.regression</a></span><span class="op">(</span>r.squared.change <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                   margin <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">5</span>, <span class="co"># number of total predictors</span></span>
<span>                   k.tested <span class="op">=</span> <span class="fl">2</span>, <span class="co"># number of tested predictors</span></span>
<span>                   power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Hierarchical Linear Regression (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : 0 &lt;= Change in R-squared &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Change in R-squared &gt; margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 606  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
<p><strong>Report</strong>: We conducted a power analysis to determine the minimum required sample size to detect a small but meaningful effect in a multiple linear regression model predicting a continuous outcome variable <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> from five predictors (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math> through <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>5</mn></msub><annotation encoding="application/x-tex">X_{5}</annotation></semantics></math>). Our specific interest lies in testing the incremental contribution of two predictors (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>4</mn></msub><annotation encoding="application/x-tex">X_{4}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>5</mn></msub><annotation encoding="application/x-tex">X_{5}</annotation></semantics></math>) beyond an initial model containing three predictors (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_{3}</annotation></semantics></math>). We are interested in detecting an increase in explained variance of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.10</mn></mrow><annotation encoding="application/x-tex">\Delta R^2 = 0.10</annotation></semantics></math> using an F-test with a significance level of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math> and statistical power of 0.80. An <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\Delta R^2</annotation></semantics></math> less than 0.05 is considered to have negligible practical significance. Under these assumptions, the minimum required sample size is 606 participants.</p>
</div>
</div>
<div class="section level2">
<h2 id="single-coefficient-t-test">Single Coefficient (T-Test)<a class="anchor" aria-label="anchor" href="#single-coefficient-t-test"></a>
</h2>
<div class="section level3">
<h3 id="standardized-input">Standardized Input<a class="anchor" aria-label="anchor" href="#standardized-input"></a>
</h3>
<p>In the earlier example, assume that we want to predict a continuous variable <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> using a continuous predictor <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math> but control for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math> variables (can be a combination of binary or continuous). We are mainly interested in the effect of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math> and expect a standardized regression coefficient of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mn>0.20</mn></mrow><annotation encoding="application/x-tex">\beta_{1} = 0.20</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><mi>r</mi><mo>,</mo><mspace width="1.0em"></mspace><mi>r</mi><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
Y = \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}X_{3} + r, \quad r \sim N(0, \sigma ^ 2)
</annotation></semantics></math></p>
<p>Again, we are expecting that these three variables explain 30% of the variance in the outcome (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0.30</mn></mrow><annotation encoding="application/x-tex">R^2 = 0.30</annotation></semantics></math>). What is the minimum required sample size? It is sufficient to provide standardized regression coefficient for <code>beta</code> because <code>sd.predictor = 1</code> and <code>sd.outcome = 1</code> by default.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.linear.t.html">power.t.regression</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   r.squared <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span>                   power <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Regression Coefficient (T-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : beta - null.beta = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : beta - null.beta != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 140  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error           = 0.198</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.802</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="unstandardized-input">Unstandardized Input<a class="anchor" aria-label="anchor" href="#unstandardized-input"></a>
</h3>
<p>For unstandardized coefficients specify <code>sd.outcome</code> and <code>sd.predictor</code>. Assume we are expecting an unstandardized regression coefficient of <code>beta = 0.60</code>, a standard deviation of <code>sd.outcome = 12</code> for the outcome and a standard deviation of <code>sd.predictor = 4</code> for the main predictor. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.linear.t.html">power.t.regression</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">0.60</span>,</span>
<span>                   sd.outcome <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                   sd.predictor <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   r.squared <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span>                   power <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Regression Coefficient (T-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : beta - null.beta = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : beta - null.beta != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 140  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error           = 0.198</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.802</span></span></code></pre></div>
<p>If the main predictor is binary (e.g. treatment / control), the standardized regression coefficient is Cohen’s <em>d</em>. Standard deviation of the main predictor is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt><annotation encoding="application/x-tex">\sqrt{p(1-p)}</annotation></semantics></math> where <em>p</em> is the proportion of sample in one of the groups. Assume half of the sample is in the first group <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">p = 0.50</annotation></semantics></math>. What is the minimum required sample size? It is sufficient to provide Cohen’s <em>d</em> for <code>beta</code> (standardized difference between two groups) but specify <code>sd.predictor = sqrt(p * (1 - p))</code> where <em>p</em> is the proportion of subjects in one of the groups.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.50</span></span>
<span><span class="va">sd.predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.linear.t.html">power.t.regression</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                   sd.predictor <span class="op">=</span> <span class="va">sd.predictor</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   r.squared <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span>                   power <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Regression Coefficient (T-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : beta - null.beta = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : beta - null.beta != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 552  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error           = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="non-inferiority-3">Non-inferiority<a class="anchor" aria-label="anchor" href="#non-inferiority-3"></a>
</h3>
<p>The intervention is expected to be non-inferior to some earlier or other interventions. Assume that the effect of an earlier or some other intervention is <code>beta = 0.10</code>. The <code>beta - null.beta</code> is expected to be positive and should be at least -0.05 (<code>margin = -0.05</code>). What is the minimum required sample size?</p>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p>This is the case when higher values of an outcome is better. When lower values of an outcome is better the <code>beta - null.beta</code> difference is expected to be NEGATIVE and the <code>margin</code> takes POSITIVE values.</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.50</span></span>
<span><span class="va">sd.predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.linear.t.html">power.t.regression</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                   null.beta <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                   margin <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>,</span>
<span>                   sd.predictor <span class="op">=</span> <span class="va">sd.predictor</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   r.squared <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span>                   power <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Regression Coefficient (T-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : beta - null.beta &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : beta - null.beta &gt;  margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 770  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error           = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="superiority-2">Superiority<a class="anchor" aria-label="anchor" href="#superiority-2"></a>
</h3>
<p>The intervention is expected to be superior to some earlier or other interventions. Assume that the effect of an earlier or some other intervention is <code>beta = 0.10</code>. The <code>beta - null.beta</code> is expected to be positive and should be at least 0.05 (<code>margin = 0.05</code>). What is the minimum required sample size?</p>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p>This is the case when higher values of an outcome is better. When lower values of an outcome is better <code>beta - null.beta</code> difference is expected to be NEGATIVE and the <code>margin</code> takes NEGATIVE values.</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.50</span></span>
<span><span class="va">sd.predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.linear.t.html">power.t.regression</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                   null.beta <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                   margin <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   sd.predictor <span class="op">=</span> <span class="va">sd.predictor</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   r.squared <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span>                   power <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Regression Coefficient (T-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : beta - null.beta &lt;= margin </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : beta - null.beta &gt;  margin </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 6934  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error           = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="equivalence-4">Equivalence<a class="anchor" aria-label="anchor" href="#equivalence-4"></a>
</h3>
<p>The intervention is expected to be equivalent to some earlier or other interventions. Assume the effect of an earlier or some other intervention is <code>beta = 0.20</code>. The <code>beta - null.beta</code> is expected to be within -0.05 and 0.05 (<code>margin = c(-0.05, 0.05)</code>). What is the minimum required sample size?</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.50</span></span>
<span><span class="va">sd.predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.linear.t.html">power.t.regression</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                   null.beta <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                   margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                   sd.predictor <span class="op">=</span> <span class="va">sd.predictor</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   r.squared <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span>                   power <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   alternative <span class="op">=</span> <span class="st">"two.one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Regression Coefficient (T-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : beta - null.beta &lt;= min(margin) or </span></span>
<span><span class="co">#&gt;                     beta - null.beta &gt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : beta - null.beta &gt; min(margin) and </span></span>
<span><span class="co">#&gt;                     beta - null.beta &lt; max(margin)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 9593  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error           = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="minimum-effect-3">Minimum Effect<a class="anchor" aria-label="anchor" href="#minimum-effect-3"></a>
</h3>
<p>The intervention effect is expected to be different from the smallest value that matters to policy and practice. The <code>beta - null.beta</code> is expected to be less than -0.05 or greater than 0.05 (<code>margin = c(-0.05, 0.05)</code>). What is the minimum required sample size?</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.50</span></span>
<span><span class="va">sd.predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.linear.t.html">power.t.regression</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                   margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                   sd.predictor <span class="op">=</span> <span class="va">sd.predictor</span>,</span>
<span>                   k.total <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   r.squared <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span>                   power <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   alternative <span class="op">=</span> <span class="st">"two.one.sided"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Regression Coefficient (T-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : beta - null.beta &gt;= min(margin) and </span></span>
<span><span class="co">#&gt;                     beta - null.beta &lt;= max(margin) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : beta - null.beta &lt; min(margin) or </span></span>
<span><span class="co">#&gt;                     beta - null.beta &gt; max(margin) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size            = 981  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error           = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
<p><br><br></p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="regression-logistic-walds-z-test">Regression: Logistic (Wald’s Z-Test)<a class="anchor" aria-label="anchor" href="#regression-logistic-walds-z-test"></a>
</h1>
<hr>
<p>In logistic regression a binary outcome variable (0 / 1: failure / success, dead / alive, absent / present) is modeled by predicting probability of being in group 1 (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>1</mn></msub><annotation encoding="application/x-tex">P_1</annotation></semantics></math>) via logit transformation (natural logarithm of odds). The base probability <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>0</mn></msub><annotation encoding="application/x-tex">P_0</annotation></semantics></math> is the overall probability of being in group 1 without influence of predictors in the model (null). Under alternative hypothesis, the probability of being in group 1 (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>1</mn></msub><annotation encoding="application/x-tex">P_1</annotation></semantics></math>) deviate from <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>0</mn></msub><annotation encoding="application/x-tex">P_0</annotation></semantics></math> depending on the value of the predictor; whereas under null it is same as the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>0</mn></msub><annotation encoding="application/x-tex">P_0</annotation></semantics></math>. A model with one main predictor (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>) and two other covariates (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_3</annotation></semantics></math>) can be constructed as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>P</mi><mn>1</mn></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>P</mi><mn>1</mn></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><msub><mi>X</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">ln(\frac{P_1}{1 - P_1}) = \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}X_{3}</annotation></semantics></math></p>
<p>where <br><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>0</mn></msub><mo>=</mo><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>P</mi><mn>0</mn></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>P</mi><mn>0</mn></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_0 = ln(\frac{P_0}{1 - P_0})</annotation></semantics></math><br><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>P</mi><mn>1</mn></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>P</mi><mn>1</mn></msub></mrow></mfrac><mi>/</mi><mfrac><msub><mi>P</mi><mn>0</mn></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>P</mi><mn>0</mn></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_1 = ln(\frac{P_1}{1 - P_1} / \frac{P_0}{1 - P_0})</annotation></semantics></math><br> Odds ratio is defined as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>R</mi><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msub><mi>P</mi><mn>1</mn></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>P</mi><mn>1</mn></msub></mrow></mfrac><mi>/</mi><mfrac><msub><mi>P</mi><mn>0</mn></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>P</mi><mn>0</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">OR = exp(\beta_1) = \frac{P_1}{1 - P_1} / \frac{P_0}{1 - P_0}</annotation></semantics></math><br></p>
<p><strong>Example</strong>:</p>
<p>Assume</p>
<ul>
<li>A squared multiple correlation of 0.20 between <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math> and other covariates (<code>r2.other.x = 0.20</code> in the code). It can be found in the form of adjusted R-square via regressing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math> on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_3</annotation></semantics></math>. Higher values require larger sample sizes. The default is 0 (zero).</li>
<li>A base probability of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub><mo>=</mo><mn>0.15</mn></mrow><annotation encoding="application/x-tex">P_0 = 0.15</annotation></semantics></math>. This is the rate when predictor <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X_1 = 0</annotation></semantics></math> or when <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta_1 = 0</annotation></semantics></math>.</li>
<li>Increasing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math> from 0 to 1 reduces the probability of being in group 1 from 0.15 to 0.10 (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><mn>0.10</mn></mrow><annotation encoding="application/x-tex">P_1 = 0.10</annotation></semantics></math>).</li>
</ul>
<p>What is the minimum required sample size? There are three types of specification to statistical power or sample size calculations; (i) probability specification, (ii) odds ratio specification, and (iii) regression coefficient specification (as in standard software output).</p>
<div class="section level2">
<h2 id="probability-specification">Probability Specification<a class="anchor" aria-label="anchor" href="#probability-specification"></a>
</h2>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.logistic.html">power.z.logistic</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>                 base.prob <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                 r.squared.predictor <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                 distribution <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Logistic Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Odds Ratio = 1</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Odds Ratio != 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 365  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="odds-ratio-specification">Odds Ratio Specification<a class="anchor" aria-label="anchor" href="#odds-ratio-specification"></a>
</h2>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>R</mi><mo>=</mo><mfrac><msub><mi>P</mi><mn>1</mn></msub><mrow><mn>1</mn><mo>−</mo><mi>P</mi><mn>1</mn></mrow></mfrac><mi>/</mi><mfrac><msub><mi>P</mi><mn>0</mn></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>P</mi><mn>0</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mn>0.10</mn><mrow><mn>1</mn><mo>−</mo><mn>0.10</mn></mrow></mfrac><mi>/</mi><mfrac><mn>0.15</mn><mrow><mn>1</mn><mo>−</mo><mn>0.15</mn></mrow></mfrac><mo>=</mo><mn>0.6296</mn></mrow><annotation encoding="application/x-tex">OR = \frac{P_1}{1 - P1} / \frac{P_0}{1 - P_0} = \frac{0.10}{1 - 0.10} / \frac{0.15}{1 - 0.15} = 0.6296</annotation></semantics></math></p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.logistic.html">power.z.logistic</a></span><span class="op">(</span>odds.ratio <span class="op">=</span> <span class="fl">0.6296</span>,</span>
<span>                 base.prob <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                 r.squared.predictor <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                 distribution <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Logistic Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Odds Ratio = 1</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Odds Ratio != 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 365  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="regression-coefficient">Regression Coefficient<a class="anchor" aria-label="anchor" href="#regression-coefficient"></a>
</h2>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>P</mi><mn>1</mn></msub><mrow><mn>1</mn><mo>−</mo><mi>P</mi><mn>1</mn></mrow></mfrac><mi>/</mi><mfrac><msub><mi>P</mi><mn>0</mn></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>P</mi><mn>0</mn></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.6296</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mn>0.4626</mn></mrow><annotation encoding="application/x-tex">\beta_1 = ln(\frac{P_1}{1 - P1} / \frac{P_0}{1 - P_0}) = ln(0.6296) = -0.4626</annotation></semantics></math></p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.logistic.html">power.z.logistic</a></span><span class="op">(</span>beta1 <span class="op">=</span> <span class="op">-</span><span class="fl">0.4626</span>,</span>
<span>                 base.prob <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                 r.squared.predictor <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                 distribution <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Logistic Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Odds Ratio = 1</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Odds Ratio != 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 365  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="change-distribution">Change Distribution<a class="anchor" aria-label="anchor" href="#change-distribution"></a>
</h2>
<p><strong>Change the distribution parameters of predictor X</strong>:</p>
<p>The mean and standard deviation of a normally distributed main predictor is 0 and 1 by default. They can be modified. In the following example the mean is 20 and the standard deviation is 8.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="st">"normal"</span>, mean <span class="op">=</span> <span class="fl">20</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.logistic.html">power.z.logistic</a></span><span class="op">(</span>beta1 <span class="op">=</span> <span class="op">-</span><span class="fl">0.4626</span>,</span>
<span>                 base.prob <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                 r.squared.predictor <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                 distribution <span class="op">=</span> <span class="va">distribution</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Logistic Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Odds Ratio = 1</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Odds Ratio != 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 591  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><strong>Change the distribution family of predictor X</strong>:</p>
<p>More distribution types are supported by the function. For example, the main predictor can be binary (e.g. treatment / control groups). Often half of the sample is assigned to the treatment group and the other half to the control (<code>prob = 0.50</code> by default).</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.logistic.html">power.z.logistic</a></span><span class="op">(</span>beta1 <span class="op">=</span> <span class="op">-</span><span class="fl">0.4626</span>,</span>
<span>                 base.prob <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                 r.squared.predictor <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                 distribution <span class="op">=</span> <span class="st">"bernoulli"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Logistic Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Bernoulli</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Odds Ratio = 1</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Odds Ratio != 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 1723  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><strong>Change the treatment group allocation rate of the binary predictor X</strong> (<code>prob = 0.40</code>):</p>
<p>The per-subject cost in a treatment group is sometimes substantially higher than the per-subject cost in control group. At other times, it is difficult to recruit subjects for a treatment whereas there are plenty of subjects to be considered for the control group (e.g. a long wait-list). In such cases there is some leeway to pick an unbalanced sample (but not too much unbalanced). Assume the treatment group allocation rate is 40%. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="st">"bernoulli"</span>, prob <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.logistic.html">power.z.logistic</a></span><span class="op">(</span>beta1 <span class="op">=</span> <span class="op">-</span><span class="fl">0.4626</span>,</span>
<span>                 base.prob <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>                 r.squared.predictor <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>                 power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                 distribution <span class="op">=</span> <span class="va">distribution</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Logistic Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Bernoulli</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Odds Ratio = 1</span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Odds Ratio != 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 1826  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><br><br></p>
</div>
</div>
<div class="section level1">
<h1 id="regression-poisson-walds-z-test">Regression: Poisson (Wald’s Z-Test)<a class="anchor" aria-label="anchor" href="#regression-poisson-walds-z-test"></a>
</h1>
<hr>
<p>In Poisson regression a count outcome variable (e.g. number of hospital / store / website visits, number of absence / dead / purchase in a day / week / month) is modeled by predicting incidence rate (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>) via logarithmic transformation (natural logarithm of rates). A model with one main predictor (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>) and two other covariates (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_3</annotation></semantics></math>) can be constructed as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><msub><mi>X</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">
ln(\lambda) = \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}X_{3}
</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">exp(\beta_0)</annotation></semantics></math> is the base incidence rate. <br><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_1 = ln(\frac{\lambda(X_1=1)}{\lambda(X_1=0)})</annotation></semantics></math><br> Incidence rate ratio is defined as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">exp(\beta_1) = \frac{\lambda(X_1=1)}{\lambda(X_1=0)}</annotation></semantics></math><br></p>
<p>Assume</p>
<ul>
<li>The expected base incidence rate is 1.65: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.50</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1.65</mn></mrow><annotation encoding="application/x-tex">exp(0.50) = 1.65</annotation></semantics></math>.</li>
<li>Increasing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math> from 0 to 1 reduces the mean incidence rate from 1.65 to 0.905: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>0.10</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.905</mn></mrow><annotation encoding="application/x-tex">exp(-0.10) = 0.905</annotation></semantics></math>.</li>
</ul>
<p>What is the minimum required sample size? There are two types of specification; (i) rate ratio specification (exponentiated regression coefficient), and (ii) raw regression coefficient specification (as in standard software output).</p>
<div class="section level2">
<h2 id="regression-coefficient-1">Regression Coefficient<a class="anchor" aria-label="anchor" href="#regression-coefficient-1"></a>
</h2>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.poisson.html">power.z.poisson</a></span><span class="op">(</span>beta0 <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                beta1 <span class="op">=</span> <span class="op">-</span><span class="fl">0.10</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                distribution <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Poisson Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Rate Ratio = 1 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Rate Ratio != 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 474  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="rate-ratio-specification">Rate Ratio Specification<a class="anchor" aria-label="anchor" href="#rate-ratio-specification"></a>
</h2>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.poisson.html">power.z.poisson</a></span><span class="op">(</span>base.rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.50</span><span class="op">)</span>,</span>
<span>                rate.ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.10</span><span class="op">)</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                distribution <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Poisson Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Rate Ratio = 1 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Rate Ratio != 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 474  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="change-distribution-1">Change Distribution<a class="anchor" aria-label="anchor" href="#change-distribution-1"></a>
</h2>
<p><strong>Change the distribution’s parameters for predictor X</strong>:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="st">"normal"</span>, mean <span class="op">=</span> <span class="fl">20</span>, sd <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.poisson.html">power.z.poisson</a></span><span class="op">(</span>base.rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.50</span><span class="op">)</span>,</span>
<span>                rate.ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.10</span><span class="op">)</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                distribution <span class="op">=</span> <span class="va">distribution</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Poisson Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Normal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Rate Ratio = 1 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Rate Ratio != 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 40  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
<p>The function accommodates other types of distribution. For example, the main predictor can be binary (e.g. treatment / control groups).</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regression.poisson.html">power.z.poisson</a></span><span class="op">(</span>base.rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.50</span><span class="op">)</span>,</span>
<span>                rate.ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.10</span><span class="op">)</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                distribution <span class="op">=</span> <span class="st">"bernoulli"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Poisson Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Bernoulli</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Rate Ratio = 1 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Rate Ratio != 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 2003  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><strong>Change treatment group allocation rate of the binary predictor X</strong> (<code>prob = 0.40</code>):</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="st">"bernoulli"</span>, prob <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.poisson.html">power.z.poisson</a></span><span class="op">(</span>base.rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.50</span><span class="op">)</span>,</span>
<span>                rate.ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.10</span><span class="op">)</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>                distribution <span class="op">=</span> <span class="va">distribution</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Poisson Regression Coefficient (Wald's Z-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method          : Demidenko (Variance Corrected)</span></span>
<span><span class="co">#&gt;   Predictor Dist. : Bernoulli</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : Rate Ratio = 1 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : Rate Ratio != 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 2095  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)  = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.8</span></span></code></pre></div>
<p><br><br></p>
</div>
</div>
<div class="section level1">
<h1 id="regression-mediation-z-test">Regression: Mediation (Z-Test)<a class="anchor" aria-label="anchor" href="#regression-mediation-z-test"></a>
</h1>
<hr>
<p>A simple mediation model can be constructed as in the figure.</p>
<figure><img src="reference/figures/med.png" alt="Simple Mediation Model"><figcaption aria-hidden="true">
Simple Mediation Model
</figcaption></figure><p>Regression models take the form of</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>M</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>0</mn><mi>M</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mi>a</mi></msub><mi>X</mi><mo>+</mo><mi>e</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>Y</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>0</mn><mi>Y</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mi>b</mi></msub><mi>M</mi><mo>+</mo><msub><mi>β</mi><mrow><mi>c</mi><mi>p</mi></mrow></msub><mi>X</mi><mo>+</mo><mi>ϵ</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{eqnarray}
M &amp; = &amp; \beta_{0M} + \beta_{a} X + e \\
Y &amp; = &amp; \beta_{0Y} + \beta_{b} M + \beta_{cp} X + \epsilon
\end{eqnarray}
</annotation></semantics></math></p>
<p><em>Y</em> is the outcome, <em>M</em> is the mediator, and <em>X</em> is the main predictor. The indirect effect is the product of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>a</mi></msub><annotation encoding="application/x-tex">\beta_a</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>b</mi></msub><annotation encoding="application/x-tex">\beta_b</annotation></semantics></math> path coefficients. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mrow><mi>c</mi><mi>p</mi></mrow></msub><annotation encoding="application/x-tex">\beta_{cp}</annotation></semantics></math> is the path coefficient for the direct effect. Path coefficients can be standardized or unstandardized. They are presumed to be standardized by default because the main predictor, mediator, and outcome all have standard deviations of <code>sd.predictor = 1</code>, <code>sd.mediator = 1</code>, and <code>sd.outcome = 1</code> in the function. Standard deviations should be specified for unstandardized path coefficients (you can find these values in descriptive tables in reports / publications).</p>
<div class="section level2">
<h2 id="continuous-predictor">Continuous Predictor<a class="anchor" aria-label="anchor" href="#continuous-predictor"></a>
</h2>
<p>Most software applications presume no covariates in the mediator and outcome models (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mi>M</mi><mn>2</mn></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">R^2_M = 0</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mi>M</mi><mn>2</mn></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">R^2_M = 0</annotation></semantics></math>). Even with no covariates, <em>X</em> explain some of the variance in <em>M</em> (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mi>M</mi><mn>2</mn></msubsup><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">R^2_M &gt; 0</annotation></semantics></math>) and <em>M</em> &amp; <em>X</em> explains some of the variance in <em>Y</em> (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mi>Y</mi><mn>2</mn></msubsup><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">R^2_Y &gt; 0</annotation></semantics></math>). We will almost never have an R-squared value of 0 (zero). The explained variance in the basic mediation model (the base R-squared values) can be non-trivial and is taken into account in the function by default. Thus, results may seem different from other software outputs.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># mediation model with base R-squared values</span></span>
<span><span class="fu"><a href="reference/regression.mediation.html">power.z.mediation</a></span><span class="op">(</span>beta.a <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  beta.b <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"sobel"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Indirect Effect in a Mediation Model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method            : Sobel</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : beta[a*b] = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : beta[a*b] != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 244  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error         = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
<p>To match results with other software packages, explicitly specify these parameters as 0 (zero) (<code>r.squared.mediator = 0</code> and <code>r.squared.outcome = 0</code>). There will be some warnings indicating that the function expects R-squared values greater than the base R-squared value. Note that in this case <code>beta.cp</code> argument will be ignored.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># base R-squared values are 0 (zero)</span></span>
<span><span class="co"># do not specify 'cp'</span></span>
<span><span class="fu"><a href="reference/regression.mediation.html">power.z.mediation</a></span><span class="op">(</span>beta.a <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  beta.b <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  r.squared.mediator <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                  r.squared.outcome <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"sobel"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Indirect Effect in a Mediation Model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method            : Sobel</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : beta[a*b] = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : beta[a*b] != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 252  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error         = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="binary-predictor">Binary Predictor<a class="anchor" aria-label="anchor" href="#binary-predictor"></a>
</h2>
<p>The case where the main predictor is binary can be useful in practice. A researcher might be interested in whether treatment influence the outcome through some mediators.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.50</span> <span class="co"># proportion of subjects in one of the groups</span></span>
<span><span class="va">sd.predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.mediation.html">power.z.mediation</a></span><span class="op">(</span>beta.a <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  beta.b <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  sd.predictor <span class="op">=</span> <span class="va">sd.predictor</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"sobel"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Indirect Effect in a Mediation Model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method            : Sobel</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : beta[a*b] = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : beta[a*b] != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 615  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error         = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="joint-and-monte-carlo">Joint and Monte Carlo<a class="anchor" aria-label="anchor" href="#joint-and-monte-carlo"></a>
</h2>
<p>Joint and Monte Carlo tests are only available when power is requested.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># binary X</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.50</span> <span class="co"># proportion of subjects in one of the groups</span></span>
<span><span class="va">sd.predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.mediation.html">power.z.mediation</a></span><span class="op">(</span>beta.a <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  beta.b <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  sd.predictor <span class="op">=</span> <span class="va">sd.predictor</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"joint"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Indirect Effect in a Mediation Model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method            : Joint</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : beta[a*b] = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : beta[a*b] != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 300</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error         = 0.416</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.584  &lt;&lt;</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.mediation.html">power.z.mediation</a></span><span class="op">(</span>beta.a <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  beta.b <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  sd.predictor <span class="op">=</span> <span class="va">sd.predictor</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"monte.carlo"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Indirect Effect in a Mediation Model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method            : Monte Carlo</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : beta[a*b] = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : beta[a*b] != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 300</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error         = 0.421</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.579  &lt;&lt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="covariate-adjustment">Covariate Adjustment<a class="anchor" aria-label="anchor" href="#covariate-adjustment"></a>
</h2>
<p>Covariates can be added to the mediator model, outcome model, or both. Explanatory power of the covariates (R-squared values) for the mediator and outcome models can be specified via <code>r.squared.mediator</code> and <code>r.squared.outcome</code> arguments.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># continuous X</span></span>
<span><span class="fu"><a href="reference/regression.mediation.html">power.z.mediation</a></span><span class="op">(</span>beta.a <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  beta.b <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  r.squared.mediator <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                  r.squared.outcome <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"sobel"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Indirect Effect in a Mediation Model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method            : Sobel</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : beta[a*b] = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : beta[a*b] != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 189  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error         = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
<p>In experimental design subjects are randomly assigned to treatment and control groups. The allocation usually takes place with a rate of 50% (or probability of 0.50) meaning that half of the sample is assigned to treatment and the other half to control. Thus, the mediator model is less likely to have confounder. It is more common to add covariates to the outcome model only.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># binary X</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.50</span> <span class="co"># proportion of subjects in one of the groups</span></span>
<span><span class="va">sd.predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/regression.mediation.html">power.z.mediation</a></span><span class="op">(</span>beta.a <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  beta.b <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  sd.predictor <span class="op">=</span> <span class="va">sd.predictor</span>,</span>
<span>                  r.squared.outcome <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"sobel"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Indirect Effect in a Mediation Model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Method            : Sobel</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : beta[a*b] = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : beta[a*b] != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Sample Size          = 559  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha) = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error         = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power    = 0.801</span></span></code></pre></div>
<p><br><br></p>
</div>
</div>
<div class="section level1">
<h1 id="anova-f-test">ANOVA (F-Test)<a class="anchor" aria-label="anchor" href="#anova-f-test"></a>
</h1>
<hr>
<p>In a one-way ANOVA, a researcher might be interested in comparing the means of several groups (levels of a factor) with respect to a continuous variable. In a one-way ANCOVA, they may want to adjust means for covariates. Furthermore, they may want to inspect interaction between two or three factors (two-way or three-way ANOVA), or adjust interaction for covariates (two-way or three-way ANCOVA). The following examples illustrate how to determine minimum required sample size for such designs.</p>
<div class="section level2">
<h2 id="effect-size-as-input">Effect Size as Input<a class="anchor" aria-label="anchor" href="#effect-size-as-input"></a>
</h2>
<div class="section level3">
<h3 id="one-way">One-way<a class="anchor" aria-label="anchor" href="#one-way"></a>
</h3>
<p>A researcher is expecting a difference of Cohen’s <em>d</em> = 0.50 between treatment and control groups (two levels) translating into <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.059</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.059</annotation></semantics></math> (<code>eta.squared = 0.059</code>). Means are not adjusted for any covariates. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.html">power.f.ancova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.059</span>,</span>
<span>               factor.levels <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-way Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 128  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.197</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.803</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="two-way">Two-way<a class="anchor" aria-label="anchor" href="#two-way"></a>
</h3>
<p>A researcher is expecting a partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.03</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.03</annotation></semantics></math> (<code>eta.squared = 0.03</code>) for interaction of treatment / control (Factor A: two levels) with gender (Factor B: two levels). Thus, <code>factor.levels = c(2,2)</code>. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.html">power.f.ancova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>               factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>               power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Two-way Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 256  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="three-way">Three-way<a class="anchor" aria-label="anchor" href="#three-way"></a>
</h3>
<p>A researcher is expecting a partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.02</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.02</annotation></semantics></math> (<code>eta.squared = 0.02</code>) for interaction of treatment / control (Factor A: two levels), gender (Factor B: two levels), and socio-economic status (Factor C: three levels). Thus, <code>factor.levels = c(2, 2, 3)</code>. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.html">power.f.ancova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>               factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>               power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Three-way Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 480  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.196</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.804</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="practical-effects">Practical Effects<a class="anchor" aria-label="anchor" href="#practical-effects"></a>
</h3>
<p>The smallest effect size of interest for policy and practice may differ from zero. For example, if we want to test whether <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.02</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.02</annotation></semantics></math> is meaningfully different from a null value of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>η</mi><mtext mathvariant="normal">Null</mtext><mn>2</mn></msubsup><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">\eta^2_{\text{Null}} = 0.01</annotation></semantics></math>, we can specify <code>null.eta.squared = 0.01</code>.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.html">power.f.ancova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>               null.eta.squared <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>               factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>               power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Three-way Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : 0 &lt;= eta.squared &lt;= null.eta.squared </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; null.eta.squared</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 3516  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="means-and-sds-as-input">Means and SDs as Input<a class="anchor" aria-label="anchor" href="#means-and-sds-as-input"></a>
</h2>
<p>A researcher is expecting a difference of Cohen’s <em>d</em> = 0.50 between treatment and control groups (two levels) translating into <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.059</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.059</annotation></semantics></math>, as in the earlier example. Means and standard deviations are not adjusted for any covariates. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.keppel.html">power.f.ancova.keppel</a></span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># vector of means</span></span>
<span>                      sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># vector of standard deviations</span></span>
<span>                      p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.50</span><span class="op">)</span>, <span class="co"># sample allocation rates</span></span>
<span>                      power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                      alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-way Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 128  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
<p>NOTE: Keppel procedure allows only one-way ANOVA.</p>
<p><br><br></p>
</div>
</div>
<div class="section level1">
<h1 id="anova-mixed-effects-f-test">ANOVA: Mixed-Effects (F-Test)<a class="anchor" aria-label="anchor" href="#anova-mixed-effects-f-test"></a>
</h1>
<hr>
<p><strong>The group (between) effect</strong>: A researcher might be interested in comparing the means of several groups (levels of a factor) with respect to an outcome variable (continuous) after controlling for the effect of time. The time effect can be thought as the improvement / grow / loss / deterioration in the outcome variable that happens naturally or due to unknown causes.</p>
<p><strong>The time (within) effect</strong>: A researcher might be interested in comparing the means of several time points with respect to the outcome variable after controlling for the group effect. In other words, the change across time points is not due to the group membership but due to the improvement / grow / loss / deterioration in the outcome variable that happens naturally or due to unknown causes.</p>
<p><strong>The group x time interaction</strong>: A researcher might suspect that means across groups and means across time points are not independent from each other. The amount of improvement / grow / loss / deterioration in the outcome variable depends the group membership.</p>
<div class="section level2">
<h2 id="group-effect-between">Group Effect (Between)<a class="anchor" aria-label="anchor" href="#group-effect-between"></a>
</h2>
<p><strong>Example 1: post-test only design with treatment and control groups.</strong></p>
<p>A researcher is expecting a difference of Cohen’s <em>d</em> = 0.50 on the post-test score between treatment and control groups, translating into <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.059</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.059</annotation></semantics></math>. The test is administered at a single time point; thus, the number of repeated measures is 1. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/anova.mixed.html">power.f.mixed.anova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.059</span>,</span>
<span>                    factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># c("between", "within")</span></span>
<span>                    power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    effect <span class="op">=</span> <span class="st">"between"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 128  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.197</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.803</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="time-effect-within">Time Effect (Within)<a class="anchor" aria-label="anchor" href="#time-effect-within"></a>
</h2>
<p><strong>Example 2: Pre-test vs. post-test design with treatment group only.</strong></p>
<p>A researcher is expecting a difference of Cohen’s <em>d</em> = 0.30 between post-test and pre-test scores, translating into <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.022</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.022</annotation></semantics></math>. The test is administered before and after the treatment; thus, the number of repeated measures is 2. There is treatment group but no control group. The researcher also expects a correlation of 0.50 between pre-test and post-test scores. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/anova.mixed.html">power.f.mixed.anova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.022</span>,</span>
<span>                    factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># c("between", "within")</span></span>
<span>                    power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    rho.within <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                    effect <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Repeated Measures Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 90  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.196</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.804</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="group-x-time-interaction">Group x Time Interaction<a class="anchor" aria-label="anchor" href="#group-x-time-interaction"></a>
</h2>
<p><strong>Example 3: Pre-test vs.post-test control-group design.</strong></p>
<p>A researcher is expecting a difference of Cohen’s <em>d</em> = 0.40 on the post-test scores between treatment and control groups after controlling for pre-test, translating into partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.038</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.038</annotation></semantics></math>. The test is administered before and after the treatment; thus, the number of repeated measures is 2. The researcher also expects a correlation of 0.50 between pre-test and post-test scores. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/anova.mixed.html">power.f.mixed.anova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.038</span>,</span>
<span>                    factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># c("between", "within")</span></span>
<span>                    power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    rho.within <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                    effect <span class="op">=</span> <span class="st">"between"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mixed-Effects Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 152  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.197</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.803</span></span></code></pre></div>
<p>A researcher is expecting a difference of Cohen’s <em>d</em> = 0.30 between post-test and pre-test scores after controlling for group membership, translating into partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.022</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.022</annotation></semantics></math>. There is both treatment and control groups. The researcher also expects a correlation of 0.50 between pre-test and post-test scores. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/anova.mixed.html">power.f.mixed.anova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.022</span>,</span>
<span>                    factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># c("between", "within")</span></span>
<span>                    power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    rho.within <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                    effect <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mixed-Effects Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 90  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.196</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.804</span></span></code></pre></div>
<p>The rationale for inspecting the interaction is that the benefit of the treatment may depend on the pre-test score (e.g. those with higher scores on the pre-test improve or deteriorate more). A researcher is expecting an interaction effect of partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.01</annotation></semantics></math>. The test is administered before and after the treatment; thus, the number of repeated measures is 2. There is both treatment and control groups. The researcher also expects a correlation of 0.50 between pre-test and post-test scores. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/anova.mixed.html">power.f.mixed.anova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                    factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># c("between", "within")</span></span>
<span>                    power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    rho.within <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                    effect <span class="op">=</span> <span class="st">"interaction"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mixed-Effects Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 198  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.196</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.804</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adjusted-eta-squared">Adjusted Eta-squared<a class="anchor" aria-label="anchor" href="#adjusted-eta-squared"></a>
</h2>
<p>It is possible that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>η</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\eta^2</annotation></semantics></math> is already adjusted for within-subject correlation. In this case instead of using unadjusted <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.038</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.038</annotation></semantics></math> use the adjusted <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.05</annotation></semantics></math> but specify <code>rho.within = NA</code>.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/anova.mixed.html">power.f.mixed.anova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># c("between", "within")</span></span>
<span>                    power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    rho.within <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                    effect <span class="op">=</span> <span class="st">"between"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mixed-Effects Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 152  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.198</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.802</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="practical-effects-1">Practical Effects<a class="anchor" aria-label="anchor" href="#practical-effects-1"></a>
</h2>
<p>The smallest effect size of interest for policy and practice may differ from zero. For example, if we want to test whether <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.05</annotation></semantics></math> is meaningfully different from a null value of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>η</mi><mtext mathvariant="normal">Null</mtext><mn>2</mn></msubsup><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">\eta^2_{\text{Null}} = 0.01</annotation></semantics></math>, we can specify <code>null.eta.squared = 0.01</code>.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/anova.mixed.html">power.f.mixed.anova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    null.eta.squared <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                    factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># c("between", "within")</span></span>
<span>                    power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    rho.within <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                    effect <span class="op">=</span> <span class="st">"between"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mixed-Effects Analysis of Variance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : 0 &lt;= eta.squared &lt;= null.eta.squared </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; null.eta.squared</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 380  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
<p><br><br></p>
</div>
</div>
<div class="section level1">
<h1 id="ancova-f-test">ANCOVA (F-Test)<a class="anchor" aria-label="anchor" href="#ancova-f-test"></a>
</h1>
<hr>
<div class="section level2">
<h2 id="effect-size-as-input-1">Effect Size as Input<a class="anchor" aria-label="anchor" href="#effect-size-as-input-1"></a>
</h2>
<div class="section level3">
<h3 id="one-way-1">One-way<a class="anchor" aria-label="anchor" href="#one-way-1"></a>
</h3>
<p>A researcher is expecting an adjusted difference of Cohen’s <em>d</em> = 0.45 between treatment and control groups (<code>factor.levels = 2</code>) after controlling for the pre-test (<code>k.covariates = 1</code>) translating into partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.048</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.048</annotation></semantics></math>. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.html">power.f.ancova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.048</span>,</span>
<span>               factor.levels <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               k.covariates <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 158  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
<div style="background-color:rgb(188, 224, 247); padding: 20px 20px 1px; border-radius:5px;">
<p><code>k.covariates</code> argument has trivial effect on the results. The difference between ANOVA and ANCOVA procedure depends on whether the effect (<code>eta.squared</code>) is unadjusted or covariate-adjusted.</p>
</div>
</div>
<div class="section level3">
<h3 id="two-way-1">Two-way<a class="anchor" aria-label="anchor" href="#two-way-1"></a>
</h3>
<p>A researcher is expecting a partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.02</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.02</annotation></semantics></math> for interaction of treatment / control (Factor A) with gender (Factor B) adjusted for the pre-test (<code>k.covariates = 1</code>). What is the minimum required sample size?</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.html">power.f.ancova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>               factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>               k.covariates <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Two-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 388  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="three-way-1">Three-way<a class="anchor" aria-label="anchor" href="#three-way-1"></a>
</h3>
<p>A researcher is expecting a partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.01</annotation></semantics></math> for interaction of treatment / control (Factor A), gender (Factor B), and socio-economic status (Factor C: three levels) adjusted for the pre-test (<code>k.covariates = 1</code>). What is the minimum required sample size?</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.html">power.f.ancova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>               factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>               k.covariates <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Three-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 960  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="practical-effects-2">Practical Effects<a class="anchor" aria-label="anchor" href="#practical-effects-2"></a>
</h3>
<p>The smallest effect size of interest for policy and practice may differ from zero. For example, if we want to test whether <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.048</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.048</annotation></semantics></math> is meaningfully different from a null value of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>η</mi><mtext mathvariant="normal">Null</mtext><mn>2</mn></msubsup><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">\eta^2_{\text{Null}} = 0.01</annotation></semantics></math>, we can specify <code>null.eta.squared = 0.01</code>.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.html">power.f.ancova</a></span><span class="op">(</span>eta.squared <span class="op">=</span> <span class="fl">0.048</span>,</span>
<span>               null.eta.squared <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>               factor.levels <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               k.covariates <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : 0 &lt;= eta.squared &lt;= null.eta.squared </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; null.eta.squared</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 410  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="means-and-sds-as-input-1">Means and SDs as Input<a class="anchor" aria-label="anchor" href="#means-and-sds-as-input-1"></a>
</h2>
</div>
<div class="section level2">
<h2 id="keppel-procedure">Keppel Procedure<a class="anchor" aria-label="anchor" href="#keppel-procedure"></a>
</h2>
<p>A researcher is expecting an adjusted difference of Cohen’s <em>d</em> = 0.318 between treatment and control groups after controlling for the pre-test (<code>k.covariates = 1</code>) and explanatory power of the covariates (<code>r.squared = 0.50</code>). This translates into a partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.048</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.048</annotation></semantics></math>. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.keppel.html">power.f.ancova.keppel</a></span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.318</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># vector of adjusted means</span></span>
<span>                      sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># vector of unadjusted standard deviations</span></span>
<span>                      p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.50</span><span class="op">)</span>, <span class="co"># sample allocation rates</span></span>
<span>                      r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                      k.covariates <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                      alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 158  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.198</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.802</span></span></code></pre></div>
<p>NOTE: Keppel procedure allows only one-way ANOVA.</p>
</div>
<div class="section level2">
<h2 id="shieh-procedure">Shieh Procedure<a class="anchor" aria-label="anchor" href="#shieh-procedure"></a>
</h2>
<div class="section level3">
<h3 id="one-way-2">One-way<a class="anchor" aria-label="anchor" href="#one-way-2"></a>
</h3>
<p>A researcher is expecting an adjusted difference of Cohen’s <em>d</em> = 0.318 between treatment and control groups after controlling for the pre-test (<code>k.covariates = 1</code>) and explanatory power of the covariates (<code>r.squared = 0.50</code>). This translates into a partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.048</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.048</annotation></semantics></math>. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.shieh.html">power.f.ancova.shieh</a></span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.318</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># vector of adjusted means</span></span>
<span>                      sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># vector of unadjusted standard deviations</span></span>
<span>                      p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.50</span><span class="op">)</span>, <span class="co"># sample allocation rates</span></span>
<span>                      r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                      k.covariates <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                      alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 160  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.195</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.805</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="two-way-2">Two-way<a class="anchor" aria-label="anchor" href="#two-way-2"></a>
</h3>
<p>Assume that cell means for interaction of treatment / control (Factor A) with gender (Factor B) adjusted for the pre-test (<code>k.covariates = 1</code>) and explanatory power of the covariate (<code>r.squared = 0.50</code>) are 0.30, 0.09, 0.05, 0.245, corresponding to cells A1:B1, A1:B2, A2:B1, A2:B2, respectively, with unit standard deviation for each. This translates into a partial <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mo>=</mo><mn>0.02</mn></mrow><annotation encoding="application/x-tex">\eta^2 = 0.02</annotation></semantics></math>. What is the minimum required sample size?</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ancova.shieh.html">power.f.ancova.shieh</a></span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="fl">0.09</span>, <span class="fl">0.05</span>, <span class="fl">0.245</span><span class="op">)</span>, <span class="co"># vector of adjusted means</span></span>
<span>                     sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># vector of unadjusted standard deviations</span></span>
<span>                     p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="co"># sample allocation rates</span></span>
<span>                     factor.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                     r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                     k.covariates <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                     power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>                     alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Two-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 388  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.198</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.802</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="planned-contrasts-t-test">Planned Contrasts (T-Test)<a class="anchor" aria-label="anchor" href="#planned-contrasts-t-test"></a>
</h1>
<hr>
<div class="section level2">
<h2 id="dummy-coding">Dummy Coding<a class="anchor" aria-label="anchor" href="#dummy-coding"></a>
</h2>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contr.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ancova.factorial.contrasts.html">factorial.contrasts</a></span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                 coding <span class="op">=</span> <span class="st">"treatment"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    A1 A2 A3</span></span>
<span><span class="co">#&gt; A1  1  0 -1</span></span>
<span><span class="co">#&gt; A2  0  1 -1</span></span>
<span></span>
<span><span class="co"># get contrast matrix from the contrast object</span></span>
<span><span class="va">contrast.matrix</span> <span class="op">&lt;-</span> <span class="va">contr.obj</span><span class="op">$</span><span class="va">contrast.matrix</span></span>
<span></span>
<span><span class="co"># calculate sample size given design characteristics</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ancova.shieh.html">power.f.ancova.shieh</a></span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span><span class="op">)</span>, <span class="co"># marginal means</span></span>
<span>                               sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span>
<span>                               p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span>, <span class="co"># sample allocation rate</span></span>
<span>                               contrast.matrix <span class="op">=</span> <span class="va">contrast.matrix</span>,</span>
<span>                               r.squared <span class="op">=</span> <span class="fl">0.50</span>,</span>
<span>                               k.covariates <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                               alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                               power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 1245  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span>
<span></span>
<span><span class="co"># power of planned contrasts, adjusted for alpha level</span></span>
<span><span class="fu"><a href="reference/ancova.contrasts.html">power.t.contrasts</a></span><span class="op">(</span><span class="va">design</span>, adjust.alpha <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multiple Contrast Analyses (T-Tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : psi = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : psi != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;  contr comparison   psi      d    ncp n.total power</span></span>
<span><span class="co">#&gt;      1  A1 &lt;=&gt; A3 -0.05 -0.071 -1.018    1245 0.111</span></span>
<span><span class="co">#&gt;      2  A2 &lt;=&gt; A3  0.10  0.141  2.036    1245 0.418</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="helmert-coding">Helmert Coding<a class="anchor" aria-label="anchor" href="#helmert-coding"></a>
</h2>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contr.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ancova.factorial.contrasts.html">factorial.contrasts</a></span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                 coding <span class="op">=</span> <span class="st">"helmert"</span><span class="op">)</span></span>
<span><span class="co">#&gt;        A1     A2    A3</span></span>
<span><span class="co">#&gt; A1 -0.500  0.500 0.000</span></span>
<span><span class="co">#&gt; A2 -0.167 -0.167 0.333</span></span>
<span></span>
<span><span class="co"># get contrast matrix from the contrast object</span></span>
<span><span class="va">contrast.matrix</span> <span class="op">&lt;-</span> <span class="va">contr.obj</span><span class="op">$</span><span class="va">contrast.matrix</span></span>
<span></span>
<span><span class="co"># calculate sample size given design characteristics</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ancova.shieh.html">power.f.ancova.shieh</a></span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span><span class="op">)</span>, <span class="co"># marginal means</span></span>
<span>                               sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span>
<span>                               p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span>, <span class="co"># allocation, should sum to 1</span></span>
<span>                               contrast.matrix <span class="op">=</span> <span class="va">contrast.matrix</span>,</span>
<span>                               r.squared <span class="op">=</span> <span class="fl">0.50</span>, <span class="co"># proportion of variance explained by covariates</span></span>
<span>                               k.covariates <span class="op">=</span> <span class="fl">1</span>, <span class="co"># number of covariates</span></span>
<span>                               alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                               power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 1245  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span>
<span></span>
<span><span class="co"># power of planned contrasts</span></span>
<span><span class="fu"><a href="reference/ancova.contrasts.html">power.t.contrasts</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multiple Contrast Analyses (T-Tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : psi = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : psi != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;  contr   comparison    psi      d    ncp n.total power</span></span>
<span><span class="co">#&gt;      1    A2 &lt;=&gt; A1  0.075  0.106  3.055    1245 0.863</span></span>
<span><span class="co">#&gt;      2 A3 &lt;=&gt; A1 A2 -0.008 -0.012 -0.588    1245 0.090</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="polynomial-coding">Polynomial Coding<a class="anchor" aria-label="anchor" href="#polynomial-coding"></a>
</h2>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contr.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ancova.factorial.contrasts.html">factorial.contrasts</a></span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                 coding <span class="op">=</span> <span class="st">"poly"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         A1     A2    A3</span></span>
<span><span class="co">#&gt; A.L -0.707  0.000 0.707</span></span>
<span><span class="co">#&gt; A.Q  0.408 -0.816 0.408</span></span>
<span></span>
<span><span class="co"># get contrast matrix from the contrast object</span></span>
<span><span class="va">contrast.matrix</span> <span class="op">&lt;-</span> <span class="va">contr.obj</span><span class="op">$</span><span class="va">contrast.matrix</span></span>
<span></span>
<span><span class="co"># calculate sample size given design characteristics</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ancova.shieh.html">power.f.ancova.shieh</a></span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span><span class="op">)</span>, <span class="co"># marginal means</span></span>
<span>                               sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span>
<span>                               p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span>, <span class="co"># allocation, should sum to 1</span></span>
<span>                               contrast.matrix <span class="op">=</span> <span class="va">contrast.matrix</span>,</span>
<span>                               r.squared <span class="op">=</span> <span class="fl">0.50</span>, <span class="co"># proportion of variance explained by covariates</span></span>
<span>                               k.covariates <span class="op">=</span> <span class="fl">1</span>, <span class="co"># number of covariates</span></span>
<span>                               alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                               power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 1245  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span>
<span></span>
<span><span class="co"># power of the planned contrasts</span></span>
<span><span class="fu"><a href="reference/ancova.contrasts.html">power.t.contrasts</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multiple Contrast Analyses (T-Tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : psi = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : psi != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;  contr   comparison    psi      d    ncp n.total power</span></span>
<span><span class="co">#&gt;      1    A3 &lt;=&gt; A1  0.035  0.050  1.018    1245 0.174</span></span>
<span><span class="co">#&gt;      2 A1 A3 &lt;=&gt; A2 -0.102 -0.144 -2.939    1245 0.836</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="custom-contrasts">Custom Contrasts<a class="anchor" aria-label="anchor" href="#custom-contrasts"></a>
</h2>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># custom contrasts</span></span>
<span><span class="va">contrast.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">1</span>, A2 <span class="op">=</span> <span class="op">-</span><span class="fl">0.50</span>, A3 <span class="op">=</span> <span class="op">-</span><span class="fl">0.50</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">0.50</span>, A2 <span class="op">=</span> <span class="fl">0.50</span>, A3 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># labels are not required for custom contrasts,</span></span>
<span><span class="co"># but they make it easier to understand power.t.contrasts() output</span></span>
<span></span>
<span><span class="co"># calculate sample size given design characteristics</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ancova.shieh.html">power.f.ancova.shieh</a></span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span><span class="op">)</span>, <span class="co"># marginal means</span></span>
<span>                               sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># unadjusted standard deviations</span></span>
<span>                               p.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span>, <span class="co"># allocation, should sum to 1</span></span>
<span>                               contrast.matrix <span class="op">=</span> <span class="va">contrast.matrix</span>,</span>
<span>                               r.squared <span class="op">=</span> <span class="fl">0.50</span>, <span class="co"># proportion of variance explained by covariates</span></span>
<span>                               k.covariates <span class="op">=</span> <span class="fl">1</span>, <span class="co"># number of covariates</span></span>
<span>                               alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                               power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; One-way Analysis of Covariance (F-Test)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : eta.squared = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : eta.squared &gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 1245  &lt;&lt;</span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.199</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.801</span></span>
<span></span>
<span><span class="co"># power of the planned contrasts</span></span>
<span><span class="fu"><a href="reference/ancova.contrasts.html">power.t.contrasts</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |                POWER CALCULATION                 |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multiple Contrast Analyses (T-Tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim) : psi = 0 </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim) : psi != 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;  contr   comparison    psi      d    ncp n.total power</span></span>
<span><span class="co">#&gt;      1 A1 &lt;=&gt; A2 A3 -0.100 -0.141 -2.351    1245 0.652</span></span>
<span><span class="co">#&gt;      2 A1 A2 &lt;=&gt; A3  0.025  0.035  0.588    1245 0.090</span></span></code></pre></div>
<p><br><br></p>
</div>
</div>
<div class="section level1">
<h1 id="independence-chi-square-test">Independence (Chi-square Test)<a class="anchor" aria-label="anchor" href="#independence-chi-square-test"></a>
</h1>
<hr>
<div class="section level2">
<h2 id="vector-of-k-cells">Vector of k Cells<a class="anchor" aria-label="anchor" href="#vector-of-k-cells"></a>
</h2>
<p><strong>Effect size: Cohen’s W for goodness-of-fit test (1 x k or k x 1 table).</strong></p>
<p>How many subjects are needed to claim that girls choose STEM related majors less than males? Check the original article at <a href="https://www.aauw.org/issues/education/stem/" class="external-link uri">https://www.aauw.org/issues/education/stem/</a></p>
<p>Alternative hypothesis state that 28% of the workforce in STEM field is women whereas 72% is men (from the article). The null hypothesis assume 50% is women and 50% is men.</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prob.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.28</span>, <span class="fl">0.72</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/conversion.probs.to.w.html">probs.to.w</a></span><span class="op">(</span>prob.matrix <span class="op">=</span> <span class="va">prob.matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt;    w   df </span></span>
<span><span class="co">#&gt; 0.44 1.00</span></span>
<span><span class="co"># Degrees of freedom is k - 1 for Cohen's w.</span></span>
<span></span>
<span><span class="fu"><a href="reference/proportions.gof.html">power.chisq.gof</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">0.44</span>,</span>
<span>                df <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chi-Square Test for Goodness-of-Fit or Independence</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : P[i,j] = P0[i,j] for all (i,j) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : P[i,j] != P0[i,j] for some (i,j)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 41  &lt;&lt; </span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.196</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.804</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contingency-table-2-x-2">Contingency Table: 2 x 2<a class="anchor" aria-label="anchor" href="#contingency-table-2-x-2"></a>
</h2>
<p><strong>Effect size: Phi Coefficient (or Cramer’s V or Cohen’s W) for independence test (2 x 2 contingency table).</strong></p>
<p>How many subjects are needed to claim that girls are under-diagnosed with ADHD? Check the original article at <a href="https://time.com/growing-up-with-adhd/" class="external-link uri">https://time.com/growing-up-with-adhd/</a></p>
<p>5.6% of girls and 13.2% of boys are diagnosed with ADHD (from the article).</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prob.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.056</span>, <span class="fl">0.132</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.944</span>, <span class="fl">0.868</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">prob.matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Girl"</span>, <span class="st">"Boy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">prob.matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ADHD"</span>, <span class="st">"No ADHD"</span><span class="op">)</span></span>
<span><span class="va">prob.matrix</span></span>
<span><span class="co">#&gt;          Girl   Boy</span></span>
<span><span class="co">#&gt; ADHD    0.056 0.132</span></span>
<span><span class="co">#&gt; No ADHD 0.944 0.868</span></span>
<span></span>
<span><span class="fu"><a href="reference/conversion.probs.to.w.html">probs.to.w</a></span><span class="op">(</span>prob.matrix <span class="op">=</span> <span class="va">prob.matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt;         w        df </span></span>
<span><span class="co">#&gt; 0.1302134 1.0000000</span></span>
<span><span class="co"># Degrees of freedom is 1 for Phi coefficient.</span></span>
<span></span>
<span><span class="fu"><a href="reference/proportions.gof.html">power.chisq.gof</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">0.1302134</span>,</span>
<span>                df <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chi-Square Test for Goodness-of-Fit or Independence</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : P[i,j] = P0[i,j] for all (i,j) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : P[i,j] != P0[i,j] for some (i,j)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 463  &lt;&lt; </span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contingency-table-j-x-k">Contingency Table: j x k<a class="anchor" aria-label="anchor" href="#contingency-table-j-x-k"></a>
</h2>
<p><strong>Effect size: Cramer’s V (or Cohen’s W) for independence test (j x k contingency tables).</strong></p>
<p>How many subjects are needed to detect the relationship between depression severity and gender? Check the original article at <a href="https://doi.org/10.1016/j.jad.2019.11.121" class="external-link uri">https://doi.org/10.1016/j.jad.2019.11.121</a></p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prob.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6759</span>, <span class="fl">0.1559</span>, <span class="fl">0.1281</span>, <span class="fl">0.0323</span>, <span class="fl">0.0078</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6771</span>, <span class="fl">0.1519</span>, <span class="fl">0.1368</span>, <span class="fl">0.0241</span>, <span class="fl">0.0101</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">prob.matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Normal"</span>, <span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span>, <span class="st">"Extremely Severe"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">prob.matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span></span>
<span><span class="va">prob.matrix</span></span>
<span><span class="co">#&gt;                  Female   Male</span></span>
<span><span class="co">#&gt; Normal           0.6759 0.6771</span></span>
<span><span class="co">#&gt; Mild             0.1559 0.1519</span></span>
<span><span class="co">#&gt; Moderate         0.1281 0.1368</span></span>
<span><span class="co">#&gt; Severe           0.0323 0.0241</span></span>
<span><span class="co">#&gt; Extremely Severe 0.0078 0.0101</span></span>
<span></span>
<span><span class="fu"><a href="reference/conversion.probs.to.w.html">probs.to.w</a></span><span class="op">(</span>prob.matrix <span class="op">=</span> <span class="va">prob.matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt;          w         df </span></span>
<span><span class="co">#&gt; 0.03022008 4.00000000</span></span>
<span><span class="co"># Degrees of freedom is (nrow - 1) * (ncol - 1) for Cramer's V.</span></span>
<span></span>
<span><span class="fu"><a href="reference/proportions.gof.html">power.chisq.gof</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">0.03022008</span>,</span>
<span>                df <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; |             SAMPLE SIZE CALCULATION              |</span></span>
<span><span class="co">#&gt; +--------------------------------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chi-Square Test for Goodness-of-Fit or Independence</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Hypotheses</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   H0 (Null Claim)   : P[i,j] = P0[i,j] for all (i,j) </span></span>
<span><span class="co">#&gt;   H1 (Alt. Claim)   : P[i,j] != P0[i,j] for some (i,j)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt; Results</span></span>
<span><span class="co">#&gt; ---------------------------------------------------</span></span>
<span><span class="co">#&gt;   Total Sample Size      = 13069  &lt;&lt; </span></span>
<span><span class="co">#&gt;   Type 1 Error (alpha)   = 0.050</span></span>
<span><span class="co">#&gt;   Type 2 Error (beta)    = 0.200</span></span>
<span><span class="co">#&gt;   Statistical Power      = 0.8</span></span></code></pre></div>
<p><br><br></p>
<div style="background-color:rgb(245, 245, 245); padding: 20px 20px 1px; border-radius:5px;">
<p>Please send any bug reports, feedback or questions to <a href="mailto:bulusmetin@gmail.com">bulusmetin [at] gmail.com</a>.</p>
</div>
<hr>
<p><a href="https://github.com/metinbulus/pwrss/blob/main/NEWS.md" class="external-link">Changelog</a></p>
</div>
<div class="section level2">
<h2 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h2>
<p><a href="https://orcid.org/0000-0003-4348-6322" class="external-link">Metin Bulus</a><br><a href="https://www.uib.no/en/persons/Sebastian.Jentschke" class="external-link">Sebastian Jentschke</a></p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This work is licensed under the <a href="https://github.com/metinbulus/pwrss/blob/main/LICENSE" class="external-link">GPL 3</a>.</p>
<!---
[![License](reference/figures/license.png)](https://creativecommons.org/licenses/by-nc-sa/4.0/)
&#10;## Giving back
&#10;If you find this package helpful, please consider donating to the jamovi project (via
the Patreon-link on the left side).
If you can't give money, but would like to support us in another way, you may contribute
to translating [jamovi](https://hosted.weblate.org/engage/jamovi/), the
[jamovi documentation](https://hosted.weblate.org/engage/jamovidocs/), or the textbook
[”learning statistics with jamovi“](https://hosted.weblate.org/engage/jamovi/) into your
language.
&#10;Thank you for your support!
--->
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=pwrss" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/metinbulus/pwrss/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/metinbulus/pwrss/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing pwrss</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Metin Bulus <br><small class="roles"> Author, maintainer </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=pwrss" class="external-link"><img src="https://www.r-pkg.org/badges/version/pwrss" alt="CRAN"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0.html" class="external-link"><img src="https://img.shields.io/badge/License-GPL%20v3-green.svg" alt="License"></a></li>
<li><a href="https://cran.r-project.org/package=pwrss" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/pwrss?color=brightgreen" alt="Downloads"></a></li>
<li><a href="https://github.com/metinbulus/pwrss" class="external-link"><img src="https://img.shields.io/github/last-commit/metinbulus/pwrss?logo=GitHub" alt="Last commit"></a></li>
<li><a href="https://github.com/metinbulus/pwrss/issues" class="external-link"><img src="https://img.shields.io/github/issues/metinbulus/pwrss?color=%23fa251e&amp;logo=GitHub" alt="Register an issue"></a></li>
<li><a href="https://metinbulus.github.io/pwrss/"><img src="https://img.shields.io/badge/documentation-is_here-blue" alt="Documentation"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Metin Bulus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
